!function(e){function t(t){for(var o,r,l=t[0],s=t[1],d=t[2],c=0,m=[];c<l.length;c++)r=l[c],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&m.push(n[r][0]),n[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);for(u&&u(t);m.length;)m.shift()();return i.push.apply(i,d||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],o=!0,l=1;l<a.length;l++){var s=a[l];0!==n[s]&&(o=!1)}o&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var o={},n={3:0},i=[];function r(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=o,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/public/js";var l=window.webpackJsonp=window.webpackJsonp||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var u=s;i.push([482,0,1]),a()}({246:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return m}));var o=a(7),n=a.n(o),i=a(9),r=a(2),l=a.n(r),s=a(6);let d=[];function u(){e("button.save-to-database").removeClass("disabled")}function c(){e("#email-list-table").on("click",".delete-maillist-item",(function(t){t.stopPropagation(),t.preventDefault();let a=e(this).parent(),o=parseInt(a.attr("data-index"),10);d[o].deleted=!0,a.remove(),u()})),e("#email-list-table").on("click","td.edit-maillist-item",(function(t){t.stopPropagation(),t.preventDefault();let a=parseInt(e(this).parent().attr("data-index"),10);e("#addto-maillist-form").form("set values",d[a]),e("#add-or-update").text("Update").attr("data-index",a),e(".addto-maillist-dialog-wrapper.hide").removeClass("hide")})),e("button.add-name-to-maillist").on("click",(function(t){t.preventDefault(),t.stopPropagation(),e("#add-or-update").text("Add"),e(".addto-maillist-dialog-wrapper.hide").removeClass("hide")})),e("button.save-to-database").on("click",(function(t){t.preventDefault(),t.stopPropagation(),e(".addto-maillist-dialog-wrapper").addClass("hide"),function(){let t=Object(s.b)(),a=d.filter(e=>!e.deleted);console.log("newList: %o",a);let o={userId:t.userId,addressList:a};e(".sync.icon").addClass("loading"),n.a.post(`${i.a.user}/maillist`,o).then(t=>{e(".sync.icon.loading").removeClass("loading"),"OK"===t.data.message&&(l.a.info(`Saved! ${t.data.response}`),e("button.save-to-database").addClass("disabled"))}).catch(t=>{e(".sync.icon.loading").removeClass("loading"),l.a.error(t)})}()})),e("form[name='addtomaillist']").on("submit",(function(t){t.preventDefault(),t.stopPropagation();let a=e("#add-or-update").text(),o=e("#addto-maillist-form").form("get values");if("Add"===a){d.push({first:o.first,last:o.last,address:o.address});let t=(n=o,`\n    <tr data-index="${d.length-1}">\n      <td class="delete-maillist-item"><i class="trash alternate icon"></i></td>\n      <td class="edit-maillist-item"><i class="pencil alternate icon"></i></td>\n      <td data-name="first">${n.first}</td>\n      <td data-name="last">${n.last}</td>\n      <td data-name="address">${n.address}</td>\n    </tr>\n  `);e("#email-list-table").append(t),u(),console.log("after Add: maillist: %o",d)}else{let t=parseInt(e("#add-or-update").attr("data-index"),10);d[t]={first:o.first,last:o.last,address:o.address},e(`tr[data-index="${t}"] > td[data-name="first"]`).text(d[t].first),e(`tr[data-index="${t}"] > td[data-name="last"]`).text(d[t].last),e(`tr[data-index="${t}"] > td[data-name="address"]`).text(d[t].address),e(".addto-maillist-dialog-wrapper").addClass("hide"),u()}var n;e("#addto-maillist-form").form("clear")})),e(".addto-maillist-cancel").on("click",(function(t){t.preventDefault(),t.stopPropagation(),e(".addto-maillist-dialog-wrapper").addClass("hide")}))}function m(){let t=Object(s.b)();if(!t)return void l.a.warning("You must be signed in to edit your email list");let a=`${t.userId}/maillist`;e(".sync.icon").addClass("loading"),n()(`${i.a.user}/${a}`).then(t=>{e(".sync.icon.loading").removeClass("loading"),d=t.data.maillist;let a=function(e){return`\n    ${e.map((e,t)=>`\n      <tr data-index="${t}">\n        <td class="delete-maillist-item"><i class="trash alternate icon"></i></td>\n        <td class="edit-maillist-item"><i class="pencil alternate icon"></i></td>\n        <td data-name="first">${e.first}</td>\n        <td data-name="last">${e.last}</td>\n        <td data-name="address">${e.address}</td>\n      </tr>\n    `).join("")}\n  `}(d);e("#email-list-table").html(a),c()}).catch(t=>{e(".sync.icon.loading").removeClass("loading"),l.a.error("Error getting email list: ",t)})}}).call(this,a(4))},247:function(e,t,a){"use strict";(function(e){a.d(t,"a",(function(){return P}));var o=a(2),n=a.n(o),i=a(7),r=a.n(i),l=a(79),s=a(6),d=a(25),u=a.n(d),c=a(66),m=a.n(c),p=a(46),f=a.n(p),v=a(9),h=a(8);let b={title:{10:"The Way of Mastery",16:"Polish Way of Mastery",11:"The Impersonal Life",12:"ACIM Sparkley Edition",13:"The Raj Material",14:"A Course Of Love",15:"ACIM Original Edition"},0:[{value:"*",name:"-- Select Source --"}],12:[{value:"*",name:"All Books"},{value:"122",name:"Text"},{value:"123",name:"Workbook for Students"},{value:"124",name:"Manual for Teachers"},{value:"121",name:"Preface"}],15:[{value:"*",name:"All Books"},{value:"151",name:"Text"},{value:"152",name:"Workbook for Students"},{value:"153",name:"Manual for Teachers"}],14:[{value:"*",name:"All Books"},{value:"1404",name:"The Course"},{value:"1402",name:"The Treatises"},{value:"1403",name:"The Dialogues"}],11:[{value:"*",name:"All Books"}],13:[{value:"*",name:"All Books"},{value:"1301",name:"You Are the Answer"},{value:"1302",name:"Graduation"},{value:"1303",name:"ACIM Study Group 2002"},{value:"1304",name:"ACIM Study Group 2003"},{value:"1305",name:"ACIM Study Group 2004"},{value:"1306",name:"ACIM Study Group 2005"},{value:"1307",name:"ACIM Study Group 2006"},{value:"1308",name:"ACIM Study Group 2007"},{value:"1309",name:"ACIM Study Group 2008"},{value:"1310",name:"ACIM Study Group 2009"},{value:"1311",name:"ACIM Study Group 2010"},{value:"1312",name:"ACIM Study Group 2011"},{value:"1313",name:"ACIM Study Group 2012"},{value:"1314",name:"ACIM Study Group 2013"},{value:"1315",name:"ACIM Study Group 2014"},{value:"1316",name:"ACIM Study Group 2015"},{value:"1317",name:"ACIM Study Group 2016"},{value:"1318",name:"ACIM Study Group 2017"},{value:"1319",name:"ACIM Study Group 2018"}],10:[{value:"*",name:"All Books"},{value:"101",name:"The Jeshua Letters"},{value:"102",name:"The Way of the Servant"},{value:"103",name:"The Early Years"},{value:"104",name:"The Way of the Heart"},{value:"105",name:"The Way of Transformation"},{value:"106",name:"The Way of Knowing"}],16:[{value:"*",name:"All Books"},{value:"1601",name:"The Jeshua Letters"},{value:"1602",name:"The Way of the Servant"},{value:"1606",name:"The Early Years"},{value:"1603",name:"The Way of the Heart"},{value:"1604",name:"The Way of Transformation"},{value:"1605",name:"The Way of Knowing"}]},g={},k={},y={};function $(t,a){let o=Object(l.a)(t);Promise.all(o).then(t=>{let o=function(e,t){return`\n    <p>\n      <button class="hide-headers ui primary button">Hide Headers</button>\n    </p>\n    <p>\n      ${b.title[t.source]}<br/>\n      ${e.length} Bookmarks include topics: <em>${t.topicArray.join(" / ")}</em> <br/>\n      ${(new Date).toLocaleString()}\n    </p>\n    ${e.map(e=>{return`${t=e,`\n    <div class="ui vertical segment">\n      <div class="ui small header bookmark-header">\n        <a id="${t.bookmark.creationDate}" target="_blank" href="${t.mgr.url}?v=${t.mgr.pid}&key=${t.id}">${t.mgr.title?t.mgr.title:t.mgr.url}</a>\n        <br/>\n        <div class="ui horizontal bulleted link list">\n          ${function(e,t=!1){return e&&0!==e.length?`\n    ${e.map(e=>`\n      <div class="item">\n        <em>${t?e:e.topic}</em>\n      </div>\n    `).join("")}\n  `:'\n      <div class="item">\n        <em>Annotation has no topics</em>\n      </div>\n    '}(t.bookmark.topicList)}\n        </div>\n        ${t.mgr.comment?"<br/>":""}\n        ${t.mgr.comment?t.mgr.comment:""}\n      </div>\n      ${a=t.mgr.content,`\n    ${a.map(e=>`\n      <p>\n        ${e.text}\n      </p>\n    `).join("")}\n  `}\n      <p ${"note"!==t.mgr.type?`class='cmi-manage-quote ${t.bookmark.quote?"in-database":""} ${t.bookmark.creationDate}'`:""}>\n        ~${t.id}${"note"===t.mgr.type?"":`:${t.bookmark.creationDate}:${t.bookmark.rangeStart}`}\n      </p>\n    </div>\n  `}`;var t,a}).join("")}\n  `}(t,a);e("#activity-report").html(o)})}function C(e){return`\n    ${e.map(e=>`<div class="item ${e.deleted?" deleted":""}" data-value="${e.deleted?"*":""}${e.value}">${e.deleted?"*":""}${e.topic}</div>`).join("")}\n  `}function x(){return e("#topic-manager").form("get values")}function A(){e("#source-list").dropdown(),e("#book-list1.dropdown").dropdown(),e("#topicSelect").dropdown(),e("#activity-report").on("click",".hide-headers",(function(t){e(this).hasClass("hide")?(e(this).removeClass("hide").html("Hide Headers"),e("#activity-report .bookmark-header").removeClass("hide")):(e(this).addClass("hide").html("Show Headers"),e("#activity-report .bookmark-header").addClass("hide"))})),e("#confirmDelete").modal({closable:!1,onDeny:function(){n.a.info("Delete Canceled.")},onApprove:function(){let t=x(),a=L(t.topicList);if(e("#topicSelect").dropdown("clear"),0===a.length)return void n.a.info("No topic(s) selected.");var o,i;o=t.source,i=a,k[o].forEach(e=>{i.forEach(t=>{"<>"!==t&&t===e.value&&(e.deleted=!0)})});let r=function(e,t){let a=[];return g[e].forEach(e=>{e.bookmark.forEach(o=>{let n;o.topicList&&(n=u()(t,o.topicList,(function(e,t){return e===t.value})),n.length>0&&a.push({id:e.id,bookmark:o}))})}),a}(t.source,a);r.length>0&&function(e,t,a){t.forEach(t=>{if(t.bookmark.topicList&&t.bookmark.topicList.length>0){let e=t.bookmark.topicList.length;t.bookmark.topicList.forEach(e=>{a.includes(e.value)&&(e.deleted=!0)}),t.bookmark.deletedTopicList=t.bookmark.topicList.filter(e=>!!e.deleted),t.bookmark.topicList=t.bookmark.topicList.filter(e=>!e.deleted||(delete e.deleted,!1)),e!==t.bookmark.topicList.length&&(t.bookmark.modified=!0)}O(e,t.id)})}(t.source,r,a);let l=C(k[t.source]);e("#topic-list").html(l),n.a.success("Topics Deleted.")}}),e("#source-list").on("change",(function(){let t=x();e("#topicsLabel").text("Topics (0)");let a=t.source,o=`\n    ${b[a].map(e=>`<option value="${e.value}">${e.name}</option>`).join("")}\n  `;e("#book-list1").html(o),B(),e("#getBookmarksButton").removeAttr("disabled"),e("#deleteTopicsButton").attr("disabled",""),e("#renameTopicButton").attr("disabled",""),e("#findFriendsButton").attr("disabled",""),e("#displayBookmarksButton").attr("disabled",""),e("#bookmarksLabel").text("Bookmarks (0)"),e("#topic-list > div").length>0&&(e("#topic-list").html(""),e("#topicSelect").dropdown("clear"),e("#topicsLabel").text("Topics (0)"))})),e("#getBookmarksButton").on("click",(function(t){let a=x();if("0"===a.source)return void n.a.info("To start, first select a source");let o=Object(s.b)();if(o){if(e("#getBookmarksButton").attr("disabled",""),e("#topic-manager").addClass("loading"),k[a.source]){let t=C(k[a.source]);e("#topic-list").html(t),e("#topicsLabel").text(`Topics (${k[a.source].length})`),n.a.success(`${k[a.source].length} topics loaded`),e("#deleteTopicsButton").removeAttr("disabled"),e("#renameTopicButton").removeAttr("disabled"),e("#findFriendsButton").removeAttr("disabled"),e("#displayBookmarksButton").removeAttr("disabled")}else Object(l.d)(o.userId,a.source).then(t=>{k[a.source]=t.data.topics,k[a.source].unshift({value:"<>",topic:"< All Topics >"});let o=C(t.data.topics);e("#topic-list").html(o),e("#topicsLabel").text(`Topics (${t.data.topics.length})`),n.a.success(`${k[a.source].length} topics loaded`),e("#deleteTopicsButton").removeAttr("disabled"),e("#renameTopicButton").removeAttr("disabled"),e("#findFriendsButton").removeAttr("disabled"),e("#displayBookmarksButton").removeAttr("disabled")});g[a.source]?(e("#topic-manager").removeClass("loading"),e("#bookmarksLabel").text(`Bookmarks (${g[a.source].length})`),n.a.success(`${g[a.source].length} bookmarks loaded`)):Object(l.b)(o.userId,a.source).then(t=>{g[a.source]=t.data.response,e("#bookmarksLabel").text(`Bookmarks (${g[a.source].length})`),n.a.success(`${g[a.source].length} bookmarks loaded`),e("#topic-manager").removeClass("loading"),g[a.source].forEach(e=>{e.modified=!1})})}else n.a.error("You must be signed in to use this page")})),e("#deleteTopicsButton").on("click",(function(){let t=x();if(0===L(t.topicList).length)return e("#topicSelect").dropdown("clear"),void n.a.info("No topic(s) selected.");e("#topicsToDelete").html(`<em>${t.topicList}</em>`),e("#confirmDelete").modal("show")})),e("#renameTopicButton").on("click",(function(){let e=x();0!==e.topicList.length?e.topicList.length>1&&n.a.info("Select only ONE topic to be renamed."):n.a.info("Select topic to be renamed.")})),e("#findFriendsButton").on("click",(function(){let t=x(),a=L(t.topicList);if(a=a.filter(e=>"<>"!==e),0===a.length)return void n.a.info("Select at least one topic.");let o=w(t.source,t.book,a),i=[];o.forEach(e=>{let t=m()(e.bookmark.topicList,a,(e,t)=>e.value===t);i=i.concat(t)}),i=f()(i,(e,t)=>e.value===t.value),i.sort((e,t)=>e.value<t.value?-1:e.value>t.value?1:0);let r=function(e){return`\n    <div class="ui list">\n      ${e.map(e=>`\n        <div class="item">\n          ${e.topic}\n        </div>\n      `).join("")}\n    </div>\n  `}(i);e("#activity-report").html(r)})),e("#displayBookmarksButton").on("click",(function(){let e=x(),t=L(e.topicList);if(0===t.length)return void n.a.info("Select at least one topic.");let a=w(e.source,e.book,t);if(0===a.length)return n.a.info("No bookmarks contain selected topics"),void B();e.topicArray=t,$(a,e)})),e("#applyChangesButton").on("click",(function(){j().forEach(e=>{delete e.annotation.modified,h.a.postAnnotation(e.annotation,e.key,!1)}),E(),n.a.success("Modifications Saved")}))}function I(){e("#activity-report").on("click",".cmi-manage-quote",(function(t){t.stopPropagation(),t.preventDefault();let a=Object(s.b)();if(!a)return;if(e("#activity-report").hasClass("quote-editor-open"))return;e("#activity-report").addClass("quote-editor-open");let o={},n=e(this).text().trim(),[i,d,u]=n.substr(1).split(":"),c=e(this).prev("p").text().trim().replace(/\r?\n|\r/g," ");o.parakey=i,o.annotationId=d,o.pid=u,o.quote=c,o.userId=a.userId,o.url=Object(l.c)(i),o.citation=e(`#${d}`).text().trim(),e(this).append('\n    <form name="quote-editor" id="quote-editor-form" class="ui form">\n      <input class="hidden-field" type="text" readonly name="annotationId">\n      <input class="hidden-field" type="text" name="parakey" readonly>\n      <input class="hidden-field" type="text" name="pid" readonly>\n      <input class="hidden-field" type="text" name="userId" readonly>\n      <input class="hidden-field" type="text" name="url" readonly>\n      <input class="hidden-field" type="text" name="citation" readonly>\n      <div class="field">\n        <label>Edit Content for Display as a Quote</label>\n        <textarea name="quote" rows="5"></textarea>\n      </div>\n      <div class="field">\n        <label>Quote in Database</label>\n        <textarea name="database" readonly placeholder="Not in database." rows="5"></textarea>\n      </div>\n      <div class="fields">\n        <button class="quote-submit ui green button" type="submit">Add Quote</button>\n        <button class="quote-cancel ui red basic button">Cancel</button>\n        <div class="twelve wide field">\n          <button class="quote-delete ui red disabled right floated button">Delete</button>\n        </div>\n      </div>\n    </form>\n  '),function(t){let a=e("#quote-editor-form"),o=`${v.a.quote}/quotedata/${t.userId}/${t.parakey}:${t.annotationId}`;e("#quote-editor-form").addClass("loading"),r.a.get(o).then(o=>{o.data.quote&&(t.database=o.data.quote.quote,e("#quote-editor-form .quote-delete").removeClass("disabled"),e("#quote-editor-form button.quote-submit").text("Update Quote"),q(t.parakey,t.annotationId,!1)),e("#quote-editor-form").removeClass("loading"),a.form("set values",t)}).catch(t=>{e("#quote-editor-form").removeClass("loading")})}(o)})),e("#activity-report").on("click","#quote-editor-form .quote-submit",(function(t){t.stopPropagation(),t.preventDefault();let a=e("#quote-editor-form").form("get values"),o=e(this).text().startsWith("Add")?"Added":"Updated",i=`${v.a.quote}/quote`,l={userId:a.userId,quoteId:`${a.parakey}:${a.annotationId}`,pid:a.pid,quote:a.quote,url:a.url,citation:a.citation};T(),S(),r.a.post(i,l).then(e=>{n.a.info(`Quote ${o}`),q(a.parakey,a.annotationId)})})),e("#activity-report").on("click","#quote-editor-form .quote-cancel",(function(e){e.stopPropagation(),e.preventDefault(),T(),S()})),e("#activity-report").on("click","#quote-editor-form .quote-delete",(function(t){t.stopPropagation(),t.preventDefault();let a=e("#quote-editor-form").form("get values"),o=`${v.a.quote}/quote/${a.userId}/${a.parakey}:${a.annotationId}`;r.a.delete(o).then(t=>{var o,i;n.a.info("Quote deleted from database"),o=a.parakey,i=a.annotationId,O(o.substring(0,2),o),M(o,i,!1),e(`.${i}`).removeClass("in-database")}).catch(e=>{n.a.error(`failed to delete quote: ${e.message}`)}),T(),S()}))}function T(){e("#quote-editor-form").remove()}function S(){e("#activity-report").removeClass("quote-editor-open")}function q(t,a,o=!0){let n=t.substring(0,2);o&&(O(n,t),M(t,a,!0)),e(`.${a}`).addClass("in-database")}function B(){e("#activity-report").html("")}function w(e,t,a){let o=function(e,t){let a=[],o=!1;if(0===t.length)return a;t.includes("<>")&&(o=!0);return g[e].forEach(e=>{e.bookmark.forEach(n=>{if(o)a.push({id:e.id,bookmark:n});else if(n.topicList&&n.topicList.length>0){let o,i=0;t.forEach(e=>{o=n.topicList.findIndex(t=>t.value===e),o>-1&&i++}),i===t.length&&a.push({id:e.id,bookmark:n})}})}),a}(e,a);return 0===o.length||"*"!==t&&(o=o.filter(e=>(e.id+"x").startsWith(t))),o}function L(e){return e.split(",").filter(e=>""!==e&&!e.startsWith("*"))}function j(){let e=[];return Object.keys(y).forEach(t=>{g[t].filter(e=>e.modified).forEach(a=>{a.bookmark.filter(e=>e.modified).forEach(o=>{e.push({sid:t,key:a.id,annotation:o})})})}),e}function O(t,a){let o=a;"string"==typeof a&&(o=parseFloat(a));let n=g[t].find(e=>e.id===o);var i;n&&(n.modified=!0,y[i=t]||(y[i]={modified:!0}),e("#applyChangesButton").removeAttr("disabled"))}function E(){Object.keys(y).forEach(e=>{g[e].forEach(e=>{delete e.modified})}),y={},e("#applyChangesButton").attr("disabled","")}function M(e,t,a){let o=e.substring(0,2),i=parseFloat(e),r=parseInt(t,10),l=g[o].find(e=>e.id===i);if(!l)return n.a.error("markQuotedState(): paragraph not found"),void console.error("parakey: %s, annotationId: %s",e,t);l.modified=!0;let s=l.bookmark.find(e=>e.creationDate===r);s?(s.quote=a,s.modified=!0):(n.a.error("markQuotedState(): bookmark not found"),console.error("parakey: %s, annotationId: %s",e,t))}function P(){A(),I(),window.onbeforeunload=function(t){var a;if("disabled"!==e("#applyChangesButton").attr("disabled"))return a="Please click 'Apply' to save your changes.",void 0===t&&(t=window.event),t&&(t.returnValue=a),a}}}).call(this,a(4))},482:function(e,t,a){e.exports=a(483)},483:function(e,t,a){"use strict";a.r(t),function(e){a(86);var t=a(43),o=a(52),n=a(53),i=a(45),r=a(6),l=a(54),s=a(246),d=a(247),u=a(0),c=a(16);e(document).ready(()=>{Object(t.b)(),Object(u.c)(c.a),Object(o.a)("page"),n.a.initialize(),r.a.initialize(),i.a.initialize("transcript"),l.a.initialize(),1===e(".manage-email-list").length&&Object(s.a)(),1===e(".manage-topic-list").length&&Object(d.a)()})}.call(this,a(4))},79:function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return h})),a.d(t,"a",(function(){return b}));var o=a(7),n=a.n(o),i=a(9);const r=a(100),l=a(101),s=a(102),d=a(104),u=a(103),c=a(105),m=a(106);function p(e,t){let a=i.a.topicsEndPoint;if(!a)throw"key: topicsEndPoint not found in globals";return a=`${a}/user/${e}/topics/${t}`,n.a.get(a)}function f(e,t){let a=i.a.bookmarkApi;if(!a)throw"key: 'bookmarkApi' not found in globals";return a=`${a}/bookmark/query/${e}/${t}`,n.a.get(a)}let v={};function h(e){let t,a=e+"";return a.startsWith("12")&&(t=r.getUrl(e,!0)),a.startsWith("15")?t=l.getUrl(e,!0):a.startsWith("14")?t=s.getUrl(e,!0):a.startsWith("11")?t=u.getUrl(e,!0):a.startsWith("13")?t=d.getUrl(e,!0):a.startsWith("10")?t=c.getUrl(e,!0):a.startsWith("16")&&(t=m.getUrl(e,!0)),t}function b(e){return e.map(e=>{if(e.bookmark.selectedText){if(!e.mgr){e.mgr={};let t=JSON.parse(e.bookmark.selectedText);e.mgr.title=t.title,e.mgr.url=t.url,e.mgr.pid=t.pid,e.mgr.content=[{pid:t.pid,text:t.target.selector[1].exact}],e.mgr.comment=e.bookmark.Comment,e.mgr.note=e.bookmark.Note,e.mgr.type="selected"}return Promise.resolve(e)}if(e.mgr)return Promise.resolve(e);{let t=h(e.id);return e.mgr={},e.mgr.type="note",e.mgr.title=e.bookmark.bookTitle,e.mgr.url=t,e.mgr.pid=e.bookmark.rangeStart,e.mgr.comment=e.bookmark.Comment,e.mgr.note=e.bookmark.Note,function(e,t){return v[e]?Promise.resolve(v[e]):n.a.get(t,{responseType:"document"}).then(t=>{let a=t.data.getElementsByClassName("transcript")[0];return v[e]=a,Promise.resolve(a)})}(e.id,t).then(t=>{let a=t.getElementsByTagName("p"),o=parseInt(e.bookmark.rangeStart.substring(1),10),n=parseInt(e.bookmark.rangeEnd.substring(1),10);e.mgr.content=[];for(let t=o;t<=n;t++)a[t]?e.mgr.content.push({pid:`p${t}`,text:a[t].textContent}):e.mgr.content.push({pid:`p${t}`,text:"no data for paragraph"});return Promise.resolve(e)})}})}}});
//# sourceMappingURL=profile.js.map