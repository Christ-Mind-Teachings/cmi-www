(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(t,e,a){"use strict";a.d(e,"c",(function(){return l})),a.d(e,"e",(function(){return p})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return h})),a.d(e,"a",(function(){return u}));var n=a(5),o=a.n(n),i=a(6),r=a(28),s=a.n(r);function c(t){"string"!=typeof t&&(t=t.toString(10));let e=t.indexOf(".");if(-1===e)return`${t}.001`;let a=t.substr(0,e),n=t.substr(e+1);return`${a}.${n}${2===n.length?"0":1===n.length?"00":""}`}function l(t,e,a=""){return new Promise((n,r)=>{o.a.get(`${i.a.user}/queryAnnotation/${t}/${e}`).then(t=>{let e=t.data.response;e.forEach(t=>{t.pid=parseInt(t.annotation.rangeStart.substring(1),10),t.annotation.userId=t.userId,t.annotation.creationDate=t.creationDate,t.annotation.selectedText&&(t.annotation.selectedText=JSON.parse(t.annotation.selectedText))}),a.length>0&&(e=e.filter(t=>{if(t.annotation.topicList){return t.annotation.topicList.findIndex(t=>t.value===a)>-1}return!1})),e.sort((t,e)=>t.paraKey-e.paraKey),n(e)}).catch(t=>{r(t)})})}function p(t){let e=s()(t);return e.annotation.selectedText&&"string"!=typeof e.annotation.selectedText&&(e.annotation.selectedText=JSON.stringify(e.annotation.selectedText)),d(e.userId,e.paraKey,e.creationDate,e.annotation)}function d(t,e,a,n){"string"!=typeof a&&(a=a.toString(10)),"string"!=typeof e&&(e=e.toString(10));let r={userId:t,paraKey:e,creationDate:a,annotation:n};return new Promise((t,e)=>{o.a.post(`${i.a.user}/annotation`,r).then(e=>{t(e.data.response)}).catch(t=>{e(t)})})}function h(t,e,a){return new Promise((n,r)=>{o.a.get(`${i.a.user}/annotation/${t}/${c(e)}/${a}`).then(t=>{console.log("getAnnotation: %o",t);let e=t.data.response;e.userId?(e.annotation.userId=e.userId,e.annotation.creationDate=e.creationDate,e.annotation.selectedText&&(e.annotation.selectedText=JSON.parse(e.annotation.selectedText)),n(e.annotation)):n({})}).catch(t=>{r(t)})})}function u(t,e,a){return"string"!=typeof a&&a.toString(10),new Promise((n,r)=>{o.a.delete(`${i.a.user}/annotation/${t}/${c(e)}/${a}`).then(t=>{n(t.data.response)}).catch(t=>{r(t)})})}},12:function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var n=a(111),o=a.n(n);function i(t){return o.a.sanitize(t,{SAFE_FOR_JQUERY:!0})}},14:function(t,e,a){"use strict";a.d(e,"a",(function(){return s})),a.d(e,"c",(function(){return c})),a.d(e,"b",(function(){return l}));var n=a(15);a(3);const o={acq:"Mon Dec 13 13:30:29 HST 2021",profile:"Sat Feb 22 16:46:35 HST 2020"},i=a(27);let r;function s(t,e=!0){let a=`cfg${t}`,i=`/public/config/${t}.json`;return new Promise((t,s)=>{Object(n.a)(i,a,o).then(a=>{e&&(r=a),t(a)}).catch(t=>{s(t)})})}function c(t){let e=`cfg${t}`,a=`/public/config/${t}.json`;return t?new Promise((t,i)=>{Object(n.a)(a,e,o).then(e=>{r=e,t(!0)}).catch(t=>{r=null,console.error(t),i(t)})}):Promise.resolve(!1)}function l(t,e=!1){let a=i.decodeKey(t),n={pageKey:t,source:"CMI Library",bookId:a.bookId};return e&&(n.data=e),new Promise((t,e)=>{s(a.bookId,!1).then(e=>{n.bookTitle=e.title,n.title=e.contents[a.uid].title,n.url=`${e.base}${e.contents[a.uid].url}`,t(n)}).catch(t=>{e(t)})})}},15:function(t,e,a){"use strict";a.d(e,"c",(function(){return m})),a.d(e,"b",(function(){return g})),a.d(e,"a",(function(){return $}));var n=a(3),o=a(5),i=a.n(o);const r=a(150),s=a(152),c=a(154),l=a(156),p=a(158),d=a(160),h=a(162),u=a(165),f=a(168);function m(t){if("string"!=typeof t&&(t=`${t}`),t.startsWith("12"))return r.getUrl(t,!0);if(t.startsWith("15"))return s.getUrl(t,!0);if(t.startsWith("14"))return c.getUrl(t,!0);if(t.startsWith("11"))return p.getUrl(t,!0);if(t.startsWith("13"))return l.getUrl(t,!0);if(t.startsWith("10"))return d.getUrl(t,!0);if(t.startsWith("16"))return h.getUrl(t,!0);if(t.startsWith("17"))return u.getUrl(t,!0);if(t.startsWith("18"))return f.getUrl(t,!0);throw new Error(`getUrlByPageKey(${t}): invalid key`)}let b={};function g(t){return t.map(t=>{if(t.annotation.selectedText){if(!t.mgr){t.mgr={};let e=t.annotation.selectedText;t.mgr.title=e.title,t.mgr.url=e.url,t.mgr.pid=e.pid,t.mgr.content=[{pid:e.pid,text:e.target.selector[1].exact}],t.mgr.comment=t.annotation.Comment,t.mgr.note=t.annotation.Note,t.mgr.type="selected"}return Promise.resolve(t)}if(t.mgr)return Promise.resolve(t);{let e=m(t.paraKey);return t.mgr={},t.mgr.type="note",t.mgr.title=t.annotation.bookTitle,t.mgr.url=e,t.mgr.pid=t.annotation.rangeStart,t.mgr.comment=t.annotation.Comment,t.mgr.note=t.annotation.Note,function(t,e){return b[t]?Promise.resolve(b[t]):i.a.get(e,{responseType:"document"}).then(e=>{let a=e.data.getElementsByClassName("transcript")[0];return b[t]=a,Promise.resolve(a)})}(t.paraKey,e).then(e=>{let a=e.getElementsByTagName("p"),n=parseInt(t.annotation.rangeStart.substring(1),10),o=parseInt(t.annotation.rangeEnd.substring(1),10);t.mgr.content=[];for(let e=n;e<=o;e++)a[e]?t.mgr.content.push({pid:`p${e}`,text:a[e].textContent}):t.mgr.content.push({pid:`p${e}`,text:"no data for paragraph"});return Promise.resolve(t)})}})}function $(t,e,a){return new Promise((o,r)=>{let s=Object(n.a)(e);!s||function(t,e){let a=e[t.bid];if(!t.saveDate)return t.saveDate=a,!0;return t.saveDate!==a&&(t.saveDate=a,!0)}(s,a)?i.a.get(t).then(t=>{t.data.saveDate=a[t.data.bid],Object(n.c)(e,t.data),o(t.data)}).catch(t=>{console.error(t),r(t)}):o(s)})}},150:function(t,e,a){const n=a(151).sprintf,o=["preface","text","workbook","manual","acq"],i=["xxx",...o],r={acq:["xxx","welcome","acim","web","raj"],preface:["xxx","preface"],text:["xxx","chap0100","chap0101","chap0102","chap0200","chap0201","chap0202","chap0203","chap0204","chap0205","chap0300","chap0301","chap0302","chap0303","chap0304","chap0305","chap0306","chap0307","chap0308","chap0400","chap0401","chap0402","chap0403","chap0404","chap0405","chap0406","chap0407","chap0408","chap0500","chap0501","chap0502","chap0503","chap0504","chap0505","chap0506","chap0507","chap0508","chap0600","chap0601","chap0602","chap0603","chap0604","chap0700","chap0701","chap0702","chap0703","chap0704","chap0705","chap0706","chap0707","chap0708","chap0709","chap0710","chap0711","chap0800","chap0801","chap0802","chap0803","chap0804","chap0805","chap0806","chap0807","chap0808","chap0809","chap0810","chap0900","chap0901","chap0902","chap0903","chap0904","chap0905","chap0906","chap0907","chap0908","chap0909","chap0910","chap1000","chap1001","chap1002","chap1003","chap1004","chap1005","chap1006","chap1007","chap1100","chap1101","chap1102","chap1103","chap1104","chap1105","chap1106","chap1107","chap1108","chap1109","chap1200","chap1201","chap1202","chap1203","chap1204","chap1205","chap1206","chap1300","chap1301","chap1302","chap1303","chap1304","chap1305","chap1306","chap1307","chap1308","chap1400","chap1401","chap1402","chap1403","chap1404","chap1405","chap1406","chap1500","chap1501","chap1502","chap1503","chap1504","chap1505","chap1506","chap1507","chap1508","chap1509","chap1510","chap1600","chap1601","chap1602","chap1603","chap1604","chap1605","chap1606","chap1607","chap1700","chap1701","chap1702","chap1703","chap1704","chap1705","chap1706","chap1707","chap1708","chap1800","chap1801","chap1802","chap1803","chap1804","chap1805","chap1806","chap1807","chap1808","chap1809","chap1810","chap1900","chap1901","chap1902","chap1903","chap1904","chap1905","chap1906","chap1907","chap1908","chap1909","chap1910","chap1911","chap2000","chap2001","chap2002","chap2003","chap2004","chap2005","chap2006","chap2007","chap2008","chap2100","chap2101","chap2102","chap2103","chap2104","chap2105","chap2106","chap2107","chap2108","chap2200","chap2201","chap2202","chap2203","chap2204","chap2205","chap2206","chap2300","chap2301","chap2302","chap2303","chap2304","chap2400","chap2401","chap2402","chap2403","chap2404","chap2405","chap2406","chap2407","chap2500","chap2501","chap2502","chap2503","chap2504","chap2505","chap2506","chap2507","chap2508","chap2509","chap2600","chap2601","chap2602","chap2603","chap2604","chap2605","chap2606","chap2607","chap2608","chap2609","chap2610","chap2700","chap2701","chap2702","chap2703","chap2704","chap2705","chap2706","chap2707","chap2708","chap2800","chap2801","chap2802","chap2803","chap2804","chap2805","chap2806","chap2807","chap2900","chap2901","chap2902","chap2903","chap2904","chap2905","chap2906","chap2907","chap2908","chap2909","chap3000","chap3001","chap3002","chap3003","chap3004","chap3005","chap3006","chap3007","chap3008","chap3100","chap3101","chap3102","chap3103","chap3104","chap3105","chap3106","chap3107"],workbook:["xxx","introp1","l001","l002","l003","l004","l005","l006","l007","l008","l009","l010","l011","l012","l013","l014","l015","l016","l017","l018","l019","l020","l021","l022","l023","l024","l025","l026","l027","l028","l029","l030","l031","l032","l033","l034","l035","l036","l037","l038","l039","l040","l041","l042","l043","l044","l045","l046","l047","l048","l049","l050","review1","l051","l052","l053","l054","l055","l056","l057","l058","l059","l060","l061","l062","l063","l064","l065","l066","l067","l068","l069","l070","l071","l072","l073","l074","l075","l076","l077","l078","l079","l080","review2","l081","l082","l083","l084","l085","l086","l087","l088","l089","l090","l091","l092","l093","l094","l095","l096","l097","l098","l099","l100","l101","l102","l103","l104","l105","l106","l107","l108","l109","l110","review3","l111","l112","l113","l114","l115","l116","l117","l118","l119","l120","l121","l122","l123","l124","l125","l126","l127","l128","l129","l130","l131","l132","l133","l134","l135","l136","l137","l138","l139","l140","review4","l141","l142","l143","l144","l145","l146","l147","l148","l149","l150","l151","l152","l153","l154","l155","l156","l157","l158","l159","l160","l161","l162","l163","l164","l165","l166","l167","l168","l169","l170","review5","l171","l172","l173","l174","l175","l176","l177","l178","l179","l180","intro181","l181","l182","l183","l184","l185","l186","l187","l188","l189","l190","l191","l192","l193","l194","l195","l196","l197","l198","l199","l200","review6","l201","l202","l203","l204","l205","l206","l207","l208","l209","l210","l211","l212","l213","l214","l215","l216","l217","l218","l219","l220","introp2","forgiveness","l221","l222","l223","l224","l225","l226","l227","l228","l229","l230","salvation","l231","l232","l233","l234","l235","l236","l237","l238","l239","l240","world","l241","l242","l243","l244","l245","l246","l247","l248","l249","l250","sin","l251","l252","l253","l254","l255","l256","l257","l258","l259","l260","body","l261","l262","l263","l264","l265","l266","l267","l268","l269","l270","christ","l271","l272","l273","l274","l275","l276","l277","l278","l279","l280","holyspirit","l281","l282","l283","l284","l285","l286","l287","l288","l289","l290","realworld","l291","l292","l293","l294","l295","l296","l297","l298","l299","l300","secondcoming","l301","l302","l303","l304","l305","l306","l307","l308","l309","l310","lastjudgement","l311","l312","l313","l314","l315","l316","l317","l318","l319","l320","creation","l321","l322","l323","l324","l325","l326","l327","l328","l329","l330","ego","l331","l332","l333","l334","l335","l336","l337","l338","l339","l340","miracle","l341","l342","l343","l344","l345","l346","l347","l348","l349","l350","whatami","l351","l352","l353","l354","l355","l356","l357","l358","l359","l360","final","l361","epilog"],manual:["xxx","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","chap22","chap23","chap24","chap25","chap26","chap27","chap28","chap29","chap30","chap31"]};function s(){return{sourceId:12,keyLength:7}}function c(t){const e={sourceId:12,keyLength:7};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function l(t=location.pathname){let e={sid:12,bid:0,uid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=function(t,e,a,n,o){if(o&&(n=o),r[a])return r[a].indexOf(n);throw new Error(`unexpected bookId: ${a}`)}(...a),-1===e.uid)return-1;let o=n("%02s%01s%04s",e.sid,e.bid,e.uid);return parseInt(o,10)}function p(t){let{pid:e,pageKey:a}=c(t),n=a.toString(10),o={error:!1,message:"ok",sid:0,bookId:"",uid:0,pid:e-1};if(7!==n.length)return o.error=!0,o.message=`Integer portion of key should have a length of 7, key is: ${n}`,o;if(o.sid=parseInt(n.substr(0,2),10),12!==o.sid)return o.error=!0,o.message=`Invalid sourceId: ${o.sid}, expecting: 12`,o;let r=parseInt(n.substr(2,1),10);return o.bookId=i[r],o.uid=parseInt(n.substr(3,4),10),o}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return o},getSourceId:function(){return 12},getKeyInfo:s,parseKey:c,genPageKey:l,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=l(e)),n+a},decodeKey:p,getUrl:function(t,e=!1){let a=p(t),n="invalid";if(a.error)return"/invalid/key/";if(r[a.bookId]&&(n=r[a.bookId][a.uid],"text"===a.bookId)){let t=n.substr(4,2);n=`${t}/${n}`}return e?`/t/acim/${a.bookId}/${n}/`:`/${a.bookId}/${n}/`},describeKey:function(t){let e=p(t);if(e.error)return{key:t,error:!0,source:"acim"};let a={key:t,source:"acim",book:e.bookId,unit:r[e.bookId][e.uid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},152:function(t,e,a){const n=a(153).sprintf,o=["text","workbook","manual","acq"],i=["xxx",...o],r={acq:["xxx","welcome","acim","cims","formats","contact","timers"],text:["xxx","forward","intro","chap0101","chap0102","chap0201","chap0202","chap0203","chap0204","chap0205","chap0206","chap0301","chap0302","chap0303","chap0304","chap0305","chap0306","chap0307","chap0308","chap0309","chap0401","chap0402","chap0403","chap0404","chap0405","chap0406","chap0407","chap0408","chap0409","chap0501","chap0502","chap0503","chap0504","chap0505","chap0506","chap0507","chap0508","chap0509","chap0601","chap0602","chap0603","chap0604","chap0605","chap0701","chap0702","chap0703","chap0704","chap0705","chap0706","chap0707","chap0708","chap0709","chap0710","chap0711","chap0712","chap0801","chap0802","chap0803","chap0804","chap0805","chap0806","chap0807","chap0808","chap0809","chap0810","chap0811","chap0901","chap0902","chap0903","chap0904","chap0905","chap0906","chap0907","chap0908","chap0909","chap0910","chap0911","chap1001","chap1002","chap1003","chap1004","chap1005","chap1006","chap1007","chap1008","chap1101","chap1102","chap1103","chap1104","chap1105","chap1106","chap1107","chap1108","chap1109","chap1110","chap1201","chap1202","chap1203","chap1204","chap1205","chap1206","chap1207","chap1301","chap1302","chap1303","chap1304","chap1305","chap1306","chap1307","chap1308","chap1309","chap1401","chap1402","chap1403","chap1404","chap1405","chap1406","chap1407","chap1501","chap1502","chap1503","chap1504","chap1505","chap1506","chap1507","chap1508","chap1509","chap1510","chap1511","chap1601","chap1602","chap1603","chap1604","chap1605","chap1606","chap1607","chap1608","chap1701","chap1702","chap1703","chap1704","chap1705","chap1706","chap1707","chap1708","chap1709","chap1801","chap1802","chap1803","chap1804","chap1805","chap1806","chap1807","chap1808","chap1809","chap1810","chap1811","chap1901","chap1902","chap1903","chap1904","chap1905","chap2001","chap2002","chap2003","chap2004","chap2005","chap2006","chap2007","chap2008","chap2009","chap2101","chap2102","chap2103","chap2104","chap2105","chap2106","chap2107","chap2108","chap2109","chap2201","chap2202","chap2203","chap2204","chap2205","chap2206","chap2207","chap2301","chap2302","chap2303","chap2304","chap2305","chap2401","chap2402","chap2403","chap2404","chap2405","chap2406","chap2407","chap2408","chap2501","chap2502","chap2503","chap2504","chap2505","chap2506","chap2507","chap2508","chap2509","chap2510","chap2601","chap2602","chap2603","chap2604","chap2605","chap2606","chap2607","chap2608","chap2609","chap2610","chap2611","chap2701","chap2702","chap2703","chap2704","chap2705","chap2706","chap2707","chap2708","chap2709","chap2801","chap2802","chap2803","chap2804","chap2805","chap2806","chap2807","chap2808","chap2901","chap2902","chap2903","chap2904","chap2905","chap2906","chap2907","chap2908","chap2909","chap2910","chap3001","chap3002","chap3003","chap3004","chap3005","chap3006","chap3007","chap3008","chap3009","chap3101","chap3102","chap3103","chap3104","chap3105","chap3106","chap3107","chap3108"],workbook:["xxx","introp1","l001","l002","l003","l004","l005","l006","l007","l008","l009","l010","l011","l012","l013","l014","l015","l016","l017","l018","l019","l020","l021","l022","l023","l024","l025","l026","l027","l028","l029","l030","l031","l032","l033","l034","l035","l036","l037","l038","l039","l040","l041","l042","l043","l044","l045","l046","l047","l048","l049","l050","review1","l051","l052","l053","l054","l055","l056","l057","l058","l059","l060","l061","l062","l063","l064","l065","l066","l067","l068","l069","l070","l071","l072","l073","l074","l075","l076","l077","l078","l079","l080","review2","l081","l082","l083","l084","l085","l086","l087","l088","l089","l090","l091","l092","l093","l094","l095","l096","l097","l098","l099","l100","l101","l102","l103","l104","l105","l106","l107","l108","l109","l110","review3","l111","l112","l113","l114","l115","l116","l117","l118","l119","l120","l121","l122","l123","l124","l125","l126","l127","l128","l129","l130","l131","l132","l133","l134","l135","l136","l137","l138","l139","l140","review4","l141","l142","l143","l144","l145","l146","l147","l148","l149","l150","l151","l152","l153","l154","l155","l156","l157","l158","l159","l160","l161","l162","l163","l164","l165","l166","l167","l168","l169","l170","review5","l171","l172","l173","l174","l175","l176","l177","l178","l179","l180","intro181","l181","l182","l183","l184","l185","l186","l187","l188","l189","l190","l191","l192","l193","l194","l195","l196","l197","l198","l199","l200","review6","l201","l202","l203","l204","l205","l206","l207","l208","l209","l210","l211","l212","l213","l214","l215","l216","l217","l218","l219","l220","introp2","forgiveness","l221","l222","l223","l224","l225","l226","l227","l228","l229","l230","salvation","l231","l232","l233","l234","l235","l236","l237","l238","l239","l240","world","l241","l242","l243","l244","l245","l246","l247","l248","l249","l250","sin","l251","l252","l253","l254","l255","l256","l257","l258","l259","l260","body","l261","l262","l263","l264","l265","l266","l267","l268","l269","l270","christ","l271","l272","l273","l274","l275","l276","l277","l278","l279","l280","holyspirit","l281","l282","l283","l284","l285","l286","l287","l288","l289","l290","realworld","l291","l292","l293","l294","l295","l296","l297","l298","l299","l300","secondcoming","l301","l302","l303","l304","l305","l306","l307","l308","l309","l310","lastjudgement","l311","l312","l313","l314","l315","l316","l317","l318","l319","l320","creation","l321","l322","l323","l324","l325","l326","l327","l328","l329","l330","ego","l331","l332","l333","l334","l335","l336","l337","l338","l339","l340","miracle","l341","l342","l343","l344","l345","l346","l347","l348","l349","l350","whatami","l351","l352","l353","l354","l355","l356","l357","l358","l359","l360","final","l361","l362","l363","l364","l365","epilog"],manual:["xxx","intro","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","chap22","chap23","chap24","chap25","chap26","chap27","chap28","chap29"]};function s(t,e,a,n,o){if(o&&(n=o),r[a])return r[a].indexOf(n);throw new Error(`unexpected bookId: ${a}`)}function c(){return{sourceId:15,keyLength:7}}function l(t){const e={sourceId:15,keyLength:7};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function p(t=location.pathname){let e={sid:15,bid:0,uid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=s(...a),-1===e.uid)return-1;let o=n("%02s%01s%04s",e.sid,e.bid,e.uid);return parseInt(o,10)}function d(t){let{pid:e,pageKey:a}=l(t),n=a.toString(10),o={error:!1,message:"ok",sid:0,bookId:"",uid:0,pid:e-1};if(7!==n.length)return o.error=!0,o.message=`Integer portion of key should have a length of 7, key is: ${n}`,o;if(o.sid=parseInt(n.substr(0,2),10),15!==o.sid)return o.error=!0,o.message=`Invalid sourceId: ${o.sid}, expecting: 15`,o;let r=parseInt(n.substr(2,1),10);return o.bookId=i[r],o.uid=parseInt(n.substr(3,4),10),o}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return o},getSourceId:function(){return 15},getKeyInfo:c,parseKey:l,getUnitId:s,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,getUrl:function(t,e=!1){let a=d(t),n="invalid";if(a.error)return"/invalid/key/";if(r[a.bookId]&&(n=r[a.bookId][a.uid],"text"===a.bookId)){let t=n.substr(4,2);n=`${t}/${n}`}return e?`/t/acimoe/${a.bookId}/${n}/`:`/${a.bookId}/${n}/`},describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:"acimoe"};let a={key:t,source:"acimoe",book:e.bookId,unit:r[e.bookId][e.uid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},154:function(t,e,a){const n=a(155).sprintf,o=["course","treatise","dialog","acq"],i=["xxx",...o],r={course:["xxx","intro","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","chap22","chap23","chap24","chap25","chap26","chap27","chap28","chap29","chap30","chap31","chap32","learning1"],treatise:["xxx","t1chap01","t1chap02","t1chap03","t1chap04","t1chap05","t1chap06","t1chap07","t1chap08","t1chap09","t1chap10","t2chap01","t2chap02","t2chap03","t2chap04","t2chap05","t2chap06","t2chap07","t2chap08","t2chap09","t2chap10","t2chap11","t2chap12","t2chap13","t3chap01","t3chap02","t3chap03","t3chap04","t3chap05","t3chap06","t3chap07","t3chap08","t3chap09","t3chap10","t3chap11","t3chap12","t3chap13","t3chap14","t3chap15","t3chap16","t3chap17","t3chap18","t3chap19","t3chap20","t3chap21","t3chap22","t4chap01","t4chap02","t4chap03","t4chap04","t4chap05","t4chap06","t4chap07","t4chap08","t4chap09","t4chap10","t4chap11","t4chap12","learning2"],dialog:["xxx","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","day01","day02","day03","day04","day05","day06","day07","day08","day09","day10","day11","day12","day13","day14","day15","day16","day17","day18","day19","day20","day21","day22","day23","day24","day25","day26","day27","day28","day29","day30","day31","day32","day33","day34","day35","day36","day37","day38","day39","day40","epilog","learning3","dialog"],acq:["xxx","welcome","book","access"]};function s(t,e){if(r[t])return r[t].indexOf(e);throw new Error(`unexpected bookId: ${t}`)}function c(){return{sourceId:14,keyLength:7}}function l(t){const e={sourceId:14,keyLength:7};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function p(t=location.pathname){let e={sid:14,bid:0,uid:0,qid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=s(a[2],a[3]),-1===e.bid)return-1;let o=n("%02s%02s%03s",e.sid,e.bid,e.uid);return parseInt(o,10)}function d(t,e=!0){let{pid:a,pageKey:n}=l(t),o=n.toString(10),r={error:0,message:"ok",sid:14,bookId:"",uid:0,pid:a-1};if(7!==o.length)return r.error=!0,r.message=`Integer portion of key should have a length of 7, key is: ${o}`,r;let s=parseInt(o.substr(2,2),10);return r.bookId=i[s],r.uid=e?parseInt(o.substr(4,3),10)-1:parseInt(o.substr(4,3),10),r}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return o},getSourceId:function(){return 14},getKeyInfo:c,parseKey:l,getUnitId:s,getUrl:function(t,e=!1){let a=d(t,!1),n="invalid";return a.error?"/invalid/key/":(r[a.bookId]&&(n=r[a.bookId][a.uid]),e?`/t/acol/${a.bookId}/${n}/`:`/${a.bookId}/${n}/`)},genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,describeKey:function(t){let e=d(t,!1);if(e.error)return{key:t,error:!0,source:"acol"};let a={key:t,source:"acol",book:e.bookId,unit:r[e.bookId][e.uid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},156:function(t,e,a){const n=a(157).sprintf,o=["yaa","grad","sg2002","sg2003","sg2004","sg2005","sg2006","sg2007","sg2008","sg2009","sg2010","sg2011","sg2012","sg2013","sg2014","sg2015","sg2016","sg2017","sg2018","acq"],i=["xxx",...o],r={acq:["xxx","welcome","raj","download","web"],yaa:["xxx","acknowledgments","foreword","020782","020882","020982","021082","021182a","021182b","021282","021382","021482","021682","021782","021882a","021882b","021882c","021982","022082","022182a","022182b","022382a","022382b","022382c","022482","022582","022682a","022682b","022682c","022782","022882","030182a","030182b","030282","030382","030482a","030482b","030582a","030582b","030682a","030682b","030682c","030682d","030682e","030882","030982","031082a","031082b","031082c","031182","031382","031582","031982","032982","033082","042782","042882","042982","043082","050182","050282","050382","050782","050982","051082a","051082b","051082c","051182","051582","051782","052882","053082","060382","061082","061282","061482","061982","062182","afterword"],grad:["xxx","g000002","g000003","g010491","g010591","g011491","g011591","g011691","g011891","g012091","g012591","g012791","g020291","g020591","g020691","g021291","g021391","g021491","g022091","g022591","g030291","g030891","g031491","g031991","g032091","g032191","g032291","g032591","g032991"],sg2002:["xxx","061202","073102","080702","081402","082802","090402","091102","091802","092502","100202","101002","101702","102402","103102","110702","112102","120502","121202","121902"],sg2003:["xxx","010203","010903","011603","012303","020603","021303","022003","022703","030603","031303","032003","032703","040303","041003","042403","050103","051103","051803","052503","060103","060803","061503","062203","062903","070603","071303","072003","072703","080303","081003","081703","082403","083103","090703","091403","092103","092803","101203","101903","102603","110203","110903","111603","112303","120703","121403","122103"],sg2004:["xxx","011104","011804","012504","020104","020804","021504","022204","030704","031404","032804","040404","041104","041804","042504","050204","050904","051604","052304","053004","061304","062004","062704","071104","071804","072504","080104","080804","081504","082204","090504","091204","091904","092604","100304","101004","101704","102404","110704","112104","112804","120504","121204","121904"],sg2005:["xxx","010205","011605","012305","013005","021305","022005","030605","031305","032705","040305","041005","041705","042405","050105","050805","052205","060505","061205","061905","070305","071005","071705","072405","080705","081405","082105","082805","090405","091105","091805","100205","100905","101605","102305","110605","111305","112005","120405","121105","121805"],sg2006:["xxx","010806","011506","012206","012906","021206","022606","030406","031106","031906","040106","041506","042906","050606","052006","052706","060306","061006","061806","062406","070106","071506","073006","080506","081206","082006","090206","090906","092306","100706","101406","102106","102806","111106","111806","120206"],sg2007:["xxx","081807","082507","090907","091607","092207","100607","101407","102707","110307","111007","111807","120807","121607"],sg2008:["xxx","012008","012708","021008","021708","022408","030208","030908","032508","033008","040608","041308","042008","050408","051808","052508","060108","060808","061508","062208","070608","071308","072708","081708","083108","090708","091408","092108","100508","101908","102608","110208","110908","112308"],sg2009:["xxx","010309","011009","011709","012409","020709","022809","031409","032809","040409","041209","042509","050909","052409","053109","060709","061309","062009","071109","071809","072509","080109","080809","082909","090509","091209","091909","092709","101009","102409","103109","111409","112209","112809","120509","121909"],sg2010:["xxx","010210","011610","013010","020610","021310","030610","032010","032710","040310","041010","050110","051510","052910","060510","061210","061910","070310","071010","071710","072410","080710","082810","090410","091110","092510","100210","100910","101610","102310","110610","111310","112010","112710","120410","121810"],sg2011:["xxx","010111","010811","011511","012211","020511","021611","021911","031211","032011","032611","040311","040911","041611","042311","043011","050711","051411","052211","060411","061211","061811","062611","070911","071611","073011","080611","082011","082711","090311","091711","092411","100111","101511","102311","110511","111311","112611","120411","121111","122011"],sg2012:["xxx","010712","012212","020512","021212","021812","032412","033112","040812","041512","042212","042912","051212","052012","060312","061712","072212","072912","080412","081112","081812","082712","090812","091612","092312","093012","100812","101412","102112","110512","111212"],sg2013:["xxx","042713","050413","051113","052013","052813","060213","060913","062513","063013","070713","071413","072113","080413","081113","082513","090113","090813","091513","092313","100613","101513","102013","102713","110313","112413","122213","123013"],sg2014:["xxx","010614","011414","012814","020914","022414","030914","041314","061614","062914","091514"],sg2015:["xxx","041815","042515","050315","050915","051715","060715","061415","062115","062815","070515","071315","072115","080115","082315","091315","100215","102115","110115"],sg2016:["xxx","070316","071616","080216"],sg2017:["xxx","040817","041617","042317","043017","051217","060917","071117","072317","092317","100117","101717","120417"],sg2018:["xxx","013118","031118","081918","082918"]};function s(t,e){if(r[t])return r[t].indexOf(e);throw new Error(`unexpected bookId: ${t}`)}function c(){return{sourceId:13,keyLength:7}}function l(t){const e={sourceId:13,keyLength:7};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function p(t=location.pathname){let e={sid:13,bid:0,uid:0,qid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=s(a[2],a[3]),-1===e.bid)return-1;let o=n("%02s%02s%03s",e.sid,e.bid,e.uid);return parseInt(o,10)}function d(t){let{pid:e,pageKey:a}=l(t),n=a.toString(10),o={error:0,message:"ok",sid:13,bookId:"",uid:0,pid:e-1};if(7!==n.length)return o.error=!0,o.message=`Integer portion of key should have a length of 7, key is: ${n}`,o;let r=parseInt(n.substr(2,2),10);return o.bookId=i[r],o.uid=parseInt(n.substr(4,3),10)-1,o}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return o},getUrl:function(t,e=!1){let a=d(t),n="invalid";return a.error?"/invalid/key/":(r[a.bookId]&&(n=r[a.bookId][a.uid+1]),e?`/t/raj/${a.bookId}/${n}/`:`/${a.bookId}/${n}/`)},getSourceId:function(){return 13},getKeyInfo:c,parseKey:l,getUnitId:s,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:"raj"};let a={key:t,source:"raj",book:e.bookId,unit:r[e.bookId][e.uid+1]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},158:function(t,e,a){const n=a(159).sprintf,o=["til","acq"],i=["xxx",...o],r={acq:["xxx","welcome"],til:["xxx","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap18"]};function s(){return{sourceId:11,keyLength:8}}function c(t){const e={sourceId:11,keyLength:8};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function l(t=location.pathname){let e={sid:11,bid:0,uid:0,hasQuestions:0,qid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=function(t,e){if(r[t])return r[t].indexOf(e);throw new Error(`unexpected bookId: ${t}`)}(a[2],a[3]),-1===e.bid)return-1;5===a.length&&(e.hasQuestions=1,e.qid=parseInt(a[4].substr(1),10));let o=n("%02s%01s%02s%1s%02s",e.sid,e.bid,e.uid,e.hasQuestions,e.qid);return parseInt(o,10)}function p(t){let{pid:e,pageKey:a}=c(t),n=a.toString(10),o={error:0,message:"ok",sid:11,bookId:"",uid:0,hasQuestions:!1,qid:0,pid:e-1};if(8!==n.length)return o.error=!0,o.message=`Integer portion of key should have a length of 8, key is: ${n}`,o;let r=parseInt(n.substr(2,1),10);return o.bookId=i[r],o.uid=parseInt(n.substr(3,2),10)-1,o.hasQuestions="1"===n.substr(5,1),o.qid=parseInt(n.substr(6,2),10)-1,o}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getUrl:function(t,e=!1){let a=p(t),n="invalid";return a.error?"/invalid/key/":(r[a.bookId]&&(n=r[a.bookId][a.uid+1]),e?`/t/jsb/${a.bookId}/${n}/`:`/${a.bookId}/${n}/`)},getBooks:function(){return o},getSourceId:function(){return 11},getKeyInfo:s,parseKey:c,genPageKey:l,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=l(e)),n+a},decodeKey:p,describeKey:function(t){let e=p(t);if(e.error)return{key:t,error:!0,source:"jsb"};let a={key:t,source:"jsb",book:e.bookId,unit:r[e.bookId][e.uid+1]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},160:function(t,e,a){const n=a(161).sprintf,o=["tjl","wos","early","woh","wot","wok","acq","topics"],i=["xxx",...o],r={acq:["xxx","welcome","wom","web"],tjl:["xxx","ack","foreword","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","epilogue"],wos:["xxx","foreword","preface","chap01","chap02","chap03","chap04","afterwords","epilog","prayer"],early:["xxx","ble","c2s","hoe","ign","com","dbc","dth","fem","gar","hea","hoi","hsp","joy1","joy2","lht","moa","mot","wak","wlk","illusions","easter","freedom","purpose","pow","toc","light","peace","perception","seeking","shr","doorway","holyr","teach"],topics:["xxx","jeshua","woh","wohexercises","wot","wotexercises","wok","wokexercises","god","creation","christmind","christ","creator","purpose","forgiveness","selflove","karma"]};function s(t,e){if("woh"===t||"wot"===t||"wok"===t)return n("l%02s",e);if(r[t])return r[t][e];throw new Error(`unexpected bookId: ${t}`)}function c(){return{sourceId:10,keyLength:8}}function l(t){const e={sourceId:10,keyLength:8};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function p(t=location.pathname){let e={sid:10,bid:0,uid:0,hasQuestions:0,qid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[2]),-1===e.bid)return-1;if(e.uid=function(t,e,a=!1){if("woh"===t||"wot"===t||"wok"===t)return parseInt(e.substr(1),10);if(r[t])return r[t].indexOf(e);throw new Error(`unexpected bookId: ${t}`)}(a[2],a[3]),-1===e.bid)return-1;5===a.length&&(e.hasQuestions=1,e.qid=parseInt(a[4].substr(1),10));let o=n("%02s%01s%02s%1s%02s",e.sid,e.bid,e.uid,e.hasQuestions,e.qid);return parseInt(o,10)}function d(t,e=!0){let{pid:a,pageKey:n}=l(t),o=n.toString(10),r={error:0,message:"ok",sid:10,bookId:"",uid:0,hasQuestions:!1,qid:0,pid:a-1};if(8!==o.length)return r.error=!0,r.message=`Integer portion of key should have a length of 8, key is: ${o}`,r;let s=parseInt(o.substr(2,1),10);return r.bookId=i[s],e?(r.uid=parseInt(o.substr(3,2),10)-1,r.qid=parseInt(o.substr(6,2),10)-1):(r.uid=parseInt(o.substr(3,2),10),r.qid=parseInt(o.substr(6,2),10)),r.hasQuestions="1"===o.substr(5,1),r}t.exports={getBooks:function(){return o},getSourceId:function(){return 10},getKeyInfo:c,getUrl:function(t,e=!1){let a,n=d(t,!1),o="invalid",i=`/${n.bookId}`;return n.error?"/invalid/key/":(o=s(n.bookId,n.uid),i=`${i}/${o}/`,n.hasQuestions&&(a=`q${n.qid}`,i=`${i}${a}/`),e?`/t/wom${i}`:i)},parseKey:l,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,describeKey:function(t){let e=d(t,!1);if(e.error)return{key:t,error:!0,source:"wom"};let a={key:t,source:"wom",book:e.bookId};return a.unit=s(e.bookId,e.uid),e.hasQuestions&&(a.question=`q${e.qid}`),e.pid>-1&&(a.pid=`p${e.pid}`),a}}},162:function(t,e,a){const n=a(163),o=a(164).sprintf;function i(...t){let e=l(t),{unit:a,subunit:o}=r(t);if(n.contents[e])return n.contents[e].indexOf(a);throw new Error(`unexpected bookId: ${e}`)}function r(t){let e,a=3;return"t"!==t[0]&&(a=1),t.length===a+2&&(e=t[a+1]),{unit:t[a],subunit:e}}function s(){return{sourceId:n.sourceId,keyLength:9}}function c(t){const e=s();let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{paraKey:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function l(t){return"t"===t[0]?t[2]:t[0]}function p(t=location.pathname){let e={sid:n.sourceId,bid:0,uid:0,xid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=n.bookIds.indexOf(l(a)),-1===e.bid)return-1;if(e.uid=i(...a),-1===e.uid)return-1;if(e.xid=function(...t){let e=l(t),{unit:a,subunit:o}=r(t),i=`${e}2`;if(!o)return 0;if(n.contents[i])return n.contents[i].indexOf(`/${o}`);throw new Error(`unexpected bookId: ${i}`)}(...a),-1===e.xid)return-1;let s=o("%02s%02s%03s%02s",e.sid,e.bid,e.uid,e.xid);return parseInt(s,10)}function d(t){let{pid:e,pageKey:a}=c(t),o=a.toString(10),i={error:!1,key:t,message:"ok",sid:0,bookId:"",uid:0,xid:0,pid:e?e-1:-1};if(9!==o.length)return i.error=!0,i.message=`Integer portion of key should have a length of 9, key is: ${o}`,i;if(i.sid=parseInt(o.substr(0,2),10),i.sid!==n.sourceId)return i.error=!0,i.message=`Invalid sourceId: ${i.sid}, expecting: ${n.sourceId}`,i;let r=parseInt(o.substr(2,2),10);return i.bookId=n.bookIds[r],i.uid=parseInt(o.substr(4,3),10),i.xid=parseInt(o.substr(7,2),10),i}t.exports={getNumberOfUnits:function(t){if(n.contents[t])return n.contents[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return n.books},getSourceId:function(){return n.sourceId},getKeyInfo:s,parseKey:c,getUnitId:i,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,getUrl:function(t,e=!1){let a,o,i=d(t),r="/invalid/key/";return i.error?r:n.contents[i.bookId]&&(a=n.contents[i.bookId][i.uid],i.xid>0?(o=n.contents[`${i.bookId}2`][i.xid],r=`/${i.bookId}/${a}${o}/`):r=`/${i.bookId}/${a}/`,e)?`${n.prefix}${r}`:r},describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:n.sid};let a={key:t,source:n.sid,book:e.bookId,unit:n.contents[e.bookId][e.uid],subunit:n.contents[`${e.bookId}2`][e.xid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},163:function(t,e){t.exports={sourceId:16,sid:"pwom",prefix:"/t/pwom",books:["lj","wos","woh","wot","wok","early","acq"],bookIds:["xxx","lj","wos","woh","wot","wok","early","acq"],contents:{lj:["xxx","acknow","reader","forwd","intr","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","eplg"],wos:["xxx","intr","chap01","chap02","chap03","chap04","aftwrd","eplg","prayer"],woh:["xxx","preface","l01","l02","l03","l04","l05","l06","l07","l08","l09","l10","l11","l12"],woh2:["xxx","/l01qa","/l02qa","/l06qa","/l07qa","/l08qa","/l09qa","/l10qa","/l11qa","/l12qa"],wot:["xxx","preface","l01","l02","l03","l04","l05","l06","l07","l08","l09","l10","l11","l12"],wot2:["xxx","/l01qa","/l06qa","/l07qa","/l09qa","/l11qa"],wok:["xxx","preface","l01","l02","l03","l04","l05","l06","l07","l08","l09","l10","l11"],wok2:["xxx","/l02qa","/l03qa","/l04qa","/l06qa","/l10qa"],early:["xxx","intr","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10"],early2:["xxx","/chap01qa","/chap02qa","/chap03qa","/chap08qa","/chap09qa"],acq:["xxx","path","advice","video","contact"]}}},165:function(t,e,a){const n=a(166),o=a(167).sprintf;function i(...t){let e=l(t),{unit:a,subunit:o}=r(t);if(n.contents[e])return n.contents[e].indexOf(a);throw new Error(`unexpected bookId: ${e}`)}function r(t){let e,a=3;return"t"!==t[0]&&(a=1),t.length===a+2&&(e=t[a+1]),{unit:t[a],subunit:e}}function s(){return{sourceId:n.sourceId,keyLength:9}}function c(t){const e=s();let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{paraKey:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function l(t){return"t"===t[0]?t[2]:t[0]}function p(t=location.pathname){let e={sid:n.sourceId,bid:0,uid:0,xid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=n.bookIds.indexOf(l(a)),-1===e.bid)return-1;if(e.uid=i(...a),-1===e.uid)return-1;if(e.xid=function(...t){let e=l(t),{unit:a,subunit:o}=r(t),i=`${e}2`;if(!o)return 0;if(n.contents[i])return n.contents[i].indexOf(`/${o}`);throw new Error(`unexpected bookId: ${i}`)}(...a),-1===e.xid)return-1;let s=o("%02s%02s%03s%02s",e.sid,e.bid,e.uid,e.xid);return parseInt(s,10)}function d(t){let{pid:e,pageKey:a}=c(t),o=a.toString(10),i={error:!1,key:t,message:"ok",sid:0,bookId:"",uid:0,xid:0,pid:e?e-1:-1};if(9!==o.length)return i.error=!0,i.message=`Integer portion of key should have a length of 9, key is: ${o}`,i;if(i.sid=parseInt(o.substr(0,2),10),i.sid!==n.sourceId)return i.error=!0,i.message=`Invalid sourceId: ${i.sid}, expecting: ${n.sourceId}`,i;let r=parseInt(o.substr(2,2),10);return i.bookId=n.bookIds[r],i.uid=parseInt(o.substr(4,3),10),i.xid=parseInt(o.substr(7,2),10),i}t.exports={getNumberOfUnits:function(t){if(n.contents[t])return n.contents[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return n.books},getSourceId:function(){return n.sourceId},getKeyInfo:s,parseKey:c,getUnitId:i,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,getUrl:function(t,e=!1){let a,o,i=d(t),r="/invalid/key/";return i.error?r:n.contents[i.bookId]&&(a=n.contents[i.bookId][i.uid],i.xid>0?(o=n.contents[`${i.bookId}2`][i.xid],r=`/${i.bookId}/${a}${o}/`):r=`/${i.bookId}/${a}/`,e)?`${n.prefix}${r}`:r},describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:n.sid};let a={key:t,source:n.sid,book:e.bookId,unit:n.contents[e.bookId][e.uid],subunit:n.contents[`${e.bookId}2`][e.xid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},166:function(t,e){t.exports={sourceId:17,sid:"col",prefix:"/t/col",books:["book1","book2","book3","book4","book5","book6","acq"],bookIds:["xxx","book1","book2","book3","book4","book5","book6","acq"],contents:{book1:["xxx","message","foreword","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","appendix","clarifications"],book2:["xxx","message","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","clarifications"],book3:["xxx","origin","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","clarifications"],book4:["xxx","origin","description","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","clarifications"],book5:["xxx","origin","description","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","clarifications"],book6:["xxx","message","prelude","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","chap16","chap17","chap18","chap19","chap20","chap21","final","clarifications"],acq:["xxx","about","origin","description","amazon"]}}},168:function(t,e,a){const n=a(169),o=a(170).sprintf;function i(...t){let e=l(t),{unit:a,subunit:o}=r(t);if(n.contents[e])return n.contents[e].indexOf(a);throw new Error(`unexpected bookId: ${e}`)}function r(t){let e,a=3;return"t"!==t[0]&&(a=1),t.length===a+2&&(e=t[a+1]),{unit:t[a],subunit:e}}function s(){return{sourceId:n.sourceId,keyLength:9}}function c(t){const e=s();let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{paraKey:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function l(t){return"t"===t[0]?t[2]:t[0]}function p(t=location.pathname){let e={sid:n.sourceId,bid:0,uid:0,xid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=n.bookIds.indexOf(l(a)),-1===e.bid)return-1;if(e.uid=i(...a),-1===e.uid)return-1;if(e.xid=function(...t){let e=l(t),{unit:a,subunit:o}=r(t),i=`${e}2`;if(!o)return 0;if(n.contents[i])return n.contents[i].indexOf(`/${o}`);throw new Error(`unexpected bookId: ${i}`)}(...a),-1===e.xid)return-1;let s=o("%02s%02s%03s%02s",e.sid,e.bid,e.uid,e.xid);return parseInt(s,10)}function d(t){let{paraKey:e,pageKey:a}=c(t),o=a.toString(10),i={error:!1,key:t,message:"ok",sid:0,bookId:"",uid:0,xid:0,pid:e?e-1:-1};if(9!==o.length)return i.error=!0,i.message=`Integer portion of key should have a length of 9, key is: ${o}`,i;if(i.sid=parseInt(o.substr(0,2),10),i.sid!==n.sourceId)return i.error=!0,i.message=`Invalid sourceId: ${i.sid}, expecting: ${n.sourceId}`,i;let r=parseInt(o.substr(2,2),10);return i.bookId=n.bookIds[r],i.uid=parseInt(o.substr(4,3),10),i.xid=parseInt(o.substr(7,2),10),i}t.exports={getNumberOfUnits:function(t){if(n.contents[t])return n.contents[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return n.books},getSourceId:function(){return n.sourceId},getKeyInfo:s,parseKey:c,getUnitId:i,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,getUrl:function(t,e=!1){let a,o,i=d(t),r="/invalid/key/";return i.error?r:n.contents[i.bookId]&&(a=n.contents[i.bookId][i.uid],i.xid>0?(o=n.contents[`${i.bookId}2`][i.xid],r=`/${i.bookId}/${a}${o}/`):r=`/${i.bookId}/${a}/`,e)?`${n.prefix}${r}`:r},describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:n.sid};let a={key:t,source:n.sid,book:e.bookId,unit:n.contents[e.bookId][e.uid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},169:function(t,e){t.exports={sourceId:18,sid:"ftcm",prefix:"/t/ftcm",books:["book1","book2","acq"],bookIds:["xxx","book1","book2","acq"],contents:{book1:["xxx","foreword","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","epilog"],book2:["xxx","foreword","chap01","chap02","chap03","chap04","chap05","chap06","chap07","chap08","chap09","chap10","chap11","chap12","chap13","chap14","chap15","epilog"],acq:["xxx","about","amazon"]}}},2:function(t,e,a){"use strict";a.d(e,"c",(function(){return u})),a.d(e,"b",(function(){return m})),a.d(e,"a",(function(){return b}));var n=a(5),o=a.n(n),i=a(1),r=a.n(i);const[s,c,l,p]=[0,1,2,3];let d=s,h={notReady:!0};function u(t){let e,a="en";d!==l?(d=c,t.lang&&(a=t.lang),e=`/public/lang/${a}.json`,"en"!==a&&"integration"===t.env&&(e=`${t.url_prefix}${e}`),o.a.get(e).then(t=>{h=t.data,d=l}).catch(t=>{d=p,r.a.error(`Failed to load language: ${a}`),console.error("language load failed: %o",t)})):r.a.warning("language already loaded")}function f(t,e){let a;return d===s?(a=`not loaded(${t}:${e})`,console.error(a),a):d!==l?(d===c?(a=`loading(${t}:${e})`,console.error(a)):(a=`failed(${t}:${e})`,console.error(a)),a):h[t]?e?h[t][e]?h[t][e]:null:h[t]:null}function m(t,e=!1,a){if("string"!=typeof t)return null;let[n,o]=t.split(":");return e?function(t,e,a){return new Promise((n,o)=>{d==c?function t(e,o,i,r=10,s=0){if(d===c)return s<=r?void setTimeout(()=>t(e,o,i,r,s+1),i):(console.error("timeout waiting for language to load: '%s:%s'",e,o),void n(a||"timeout"));n(f(e,o))}(t,e,250):n(f(t,e))})}(n,o,a):f(n,o)}function b(t,...e){const a=e.map(t=>{let e=m(t);return e||t});return t.reduce((t,e,n)=>{let o=a[n];return void 0===o&&(o=""),`${t}${e}${o}`},"")}},21:function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return c})),a.d(e,"a",(function(){return l}));var n=a(38),o=a(3);let i;function r(t){i=t,c(),function(){var t=$(".transcript p");if(0===t.length)return;t.each((function(t){$(this).hasClass("omit")?0:$(this).parents("div.footnotes").length>0||($(this).attr("id","p"+t).addClass("cmiTranPara").prepend(`<span class='pnum'>(p${t})&nbsp;</span>`))}))}(),function(){let t=0!==$(".toggle-paragraph-markers").length,e=Object(o.a)(i),a=$(".transcript.ui.text.container"),n=a.hasClass("hide-pnum")?"off":"on";if(!t)return void $(".transcript.ui.text.container").addClass("hide-pnum");e||(e=n,Object(o.c)(i,e));e!==n&&("on"===e?a.removeClass("hide-pnum"):a.addClass("hide-pnum"));s(e)}(),$(".toggle-paragraph-markers").on("click",(function(t){t.preventDefault();let e=$(".transcript.ui.text.container");e.hasClass("hide-pnum")?(e.removeClass("hide-pnum"),Object(o.c)(i,"on"),s("on")):(e.addClass("hide-pnum"),Object(o.c)(i,"off"),s("off"))}))}function s(t){"on"===t?$(".toggle-paragraph-markers > span .paragraph-corner-icon").addClass("hide"):$(".toggle-paragraph-markers > span .paragraph-corner-icon").removeClass("hide")}function c(){$(".main.menu").visibility({type:"fixed",onFixed:function(t){},onUnfixed:function(t){}}),$(".main.menu  .ui.dropdown").dropdown({on:"hover"}),$(".source-features > .menu .item").tab()}function l(t="[data-book]"){$("#page-contents").on("mouseover",t,(function(t){n.a.to($(this),.2,{className:"+=gsap-hover"}),n.a.to($(this),.2,{scale:"1.1"})})),$("#page-contents").on("mouseout",t,(function(t){n.a.to($(this),.2,{className:"-=gsap-hover"}),n.a.to($(this),.2,{scale:"1.0"})}))}},22:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return s}));var n=a(5),o=a.n(n),i=a(6);function r(t,e){return new Promise((a,n)=>{o.a.get(`${i.a.user}/topicList/${t}/${e}`).then(t=>{let e=t.data.topics;a(e)}).catch(t=>{n(t)})})}function s(t,e,a){let n={userId:t,sourceId:e,topicList:a};return new Promise((t,e)=>{o.a.post(`${i.a.user}/topicList`,n).then(e=>{t(e.data.response)}).catch(t=>{e(t)})})}},24:function(t,e,a){"use strict";a.d(e,"b",(function(){return p}));var n=a(9),o=a.n(n),i=a(14),r=a(27),s=a.n(r);function c(t,e){return`\n    <div class="ui relaxed ordered list">\n      ${e.map((e,a)=>`\n        <a data-lid="${a+1}" class="item" href="${t}${e.url}">${e.title}</a>`).join("")}\n    </div>\n  `}function l(t){if($(".transcript").length>0||$(".profile-page").length>0){let e=location.pathname,a=$(`.toc-list a[href='${e}']`);switch(a.addClass("current-unit").removeAttr("href"),t){case"vol":case"vol2":break;default:!function(t,e){var a=s.a.getNumberOfUnits(t);let n,o,i=-1,r=-1,c=e.attr("data-lid"),l=parseInt(c,10);1===l?$("#toc-previous-page").addClass("disabled"):($("#toc-previous-page").removeClass("disabled"),i=l-1),l===a?$("#toc-next-page").addClass("disabled"):($("#toc-next-page").removeClass("disabled"),r=l+1),i>-1&&(n=$(`a[data-lid="${i}"]`).attr("href"),o=$(`a[data-lid="${i}"]`).text(),$("#toc-previous-page > span").attr("data-tooltip",`${o}`),$("#toc-previous-page").attr("href",`${n}`)),r>-1&&(n=$(`a[data-lid="${r}"]`).attr("href"),o=$(`a[data-lid="${r}"]`).text(),$("#toc-next-page > span").attr("data-tooltip",`${o}`),$("#toc-next-page").attr("href",`${n}`))}(t,a)}}}function p(){return $(".toc-modal-open").attr("data-book")}e.a={initialize:function(t){$(".toc.ui.modal").modal({dimmerSettings:{opacity:.5},observeChanges:!0,onVisible:function(){let t=$(".toc-list a.current-unit");o()(t.get(0),{isScrollable:function(t,e){return e(t)||t.className.includes("scrolling")}})}}),"transcript"===t&&function(){let t=$("#contents-modal-open").attr("data-book").toLowerCase();Object(i.a)(t).then(t=>{$(".toc-image").attr("src",`${t.image}`),$(".toc-title").html(`Table of Contents: <em>${t.title}</em>`),$(".toc-list").html(c(t.base,t.contents)),l(t.bid)}).catch(t=>{console.error(t),$(".toc-image").attr("src","/public/img/cmi/toc_modal.png"),$(".toc-title").html("Table of Contents: <em>Error</em>"),$(".toc-list").html(`<p>Error: ${t.message}</p>`),$(".toc.ui.modal").modal("show")})}(),$(".toc-modal-open").on("click",e=>{e.preventDefault();let a=$(e.currentTarget).attr("data-book").toLowerCase();"transcript"!==t?Object(i.a)(a).then(t=>{$(".toc-image").attr("src",`${t.image}`),$(".toc-title").html(`Table of Contents: <em>${t.title}</em>`),$(".toc-list").html(c(t.base,t.contents)),$(".toc.ui.modal").modal("show")}).catch(t=>{console.error(t),$(".toc-image").attr("src","/public/img/cmi/toc_modal.png"),$(".toc-title").html("Table of Contents: <em>Error</em>"),$(".toc-list").html(`<p>Error: ${t.message}</p>`),$(".toc.ui.modal").modal("show")}):$(".toc.ui.modal").modal("show")})}}},25:function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return s})),a.d(e,"c",(function(){return c}));var n=a(5),o=a.n(n),i=a(6);function r(t){return new Promise((e,a)=>{o.a.get(`${i.a.user}/mailList/${t}`).then(t=>{e(t.data.mailList)}).catch(t=>{a(t)})})}function s(t,e){return new Promise((t,a)=>{o.a.post(`${i.a.user}/mailList`,e).then(e=>{t(e.data.response)}).catch(t=>{a(t)})})}function c(t){return console.log("mailInfo: %o",t),new Promise((e,a)=>{o.a.post(`${i.a.user}/share`,t).then(t=>{200===t.status?e("success"):e(t.data.message)}).catch(t=>{a(t)})})}},27:function(t,e,a){const n=a(171).sprintf,o=["acq","profile"],i=["xxx",...o],r={acq:["xxx","welcome","overview","quick","quotes","bookmark","search","audio","accounts","profile","video","email","tech","contact"],profile:["xxx","email","topicMgt"]};function s(t,e){if(r[t])return r[t].indexOf(e);throw new Error(`unexpected bookId: ${t}`)}function c(){return{sourceId:99,keyLength:7}}function l(t){const e={sourceId:99,keyLength:7};let a=t,n=0;"number"==typeof a&&(a=t.toString(10));let o=a.indexOf(".");if(o>-1){let t=a.substr(o+1);switch(t.length){case 1:t=`${t}00`;break;case 2:t=`${t}0`}n=parseInt(t,10)}return{pid:n,pageKey:parseInt(a.substr(0,e.keyLength),10)}}function p(t=location.pathname){let e={sid:99,bid:0,uid:0,qid:0},a=function(t){let e=t;return e=t.substr(1),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),e.split("/")}(t);if(e.bid=i.indexOf(a[0]),-1===e.bid)return-1;if(e.uid=s(a[0],a[1]),-1===e.bid)return-1;let o=n("%02s%02s%03s",e.sid,e.bid,e.uid);return parseInt(o,10)}function d(t){let{pid:e,pageKey:a}=l(t),n=a.toString(10),o={error:0,message:"ok",sid:99,bookId:"",uid:0,pid:e-1};if(7!==n.length)return o.error=!0,o.message=`Integer portion of key should have a length of 7, key is: ${n}`,o;let r=parseInt(n.substr(2,2),10);return o.bookId=i[r],o.uid=parseInt(n.substr(4,3),10)-1,o}t.exports={getNumberOfUnits:function(t){if(r[t])return r[t].length-1;throw new Error(`getNumberOfUnits() unexpected bookId: ${t}`)},getBooks:function(){return o},getSourceId:function(){return 99},getKeyInfo:c,parseKey:l,getUnitId:s,genPageKey:p,genParagraphKey:function(t,e=location.pathname){let a,n=e;return a="string"==typeof t?(parseInt(t.substr(1),10)+1)/1e3:(t+1)/1e3,"string"==typeof e&&(n=p(e)),n+a},decodeKey:d,getUrl:function(t){let e=d(t),a="invalid";return e.error?"/invalid/key/":(r[e.bookId]&&(a=r[e.bookId][e.uid+1]),`/${e.bookId}/${a}/`)},describeKey:function(t){let e=d(t);if(e.error)return{key:t,error:!0,source:"www"};let a={key:t,source:"www",book:e.bookId,unit:r[e.bookId][e.uid]};return e.pid>-1&&(a.pid=`p${e.pid}`),a}}},29:function(t,e,a){"use strict";a.d(e,"a",(function(){return ye}));var n=a(11),o=a(22),i=a(4),r=a(3),s=a(46),c=a.n(s),l=a(2);let p=!1;function d(){if(!p)return $("#bookmark-filter-wrapper").removeClass("hide"),$("#page-topics-modal").modal({dimmerSettings:{opacity:.5},autofocus:!1,centered:!0,duration:400,inverted:!0,observeChanges:!0,transition:"horizontal flip",onShow:function(){!function(){if(!Yt.topicRefreshNeeded)return;let t=function(){let t=Yt.getTopics(),e=Array.from(t.keys()).map(e=>t.get(e));return e.sort((t,e)=>t.value<e.value?-1:t.value>e.value?1:0),function(t){return`\n    <select name="pageTopicList" id="page-topics-topic-list" class="search ui dropdown">\n      <option value="">Choose a topic</option>\n      ${t.map(t=>`${function(t){return`<option value="${t.value}">${t.topic}</option>`}(t)}`).join("")}\n    </select>\n  `}(e)}();$("#page-topics-modal-topic-select").html(t),$("#page-topics-topic-list").dropdown(),$("#page-topics-modal-loading").removeClass("active").addClass("disabled"),Yt.topicRefreshNeeded=!1}()},onVisible:function(){},onHidden:function(){}}),$("#page-topics-modal-open").on("click",t=>{t.preventDefault(),$("#page-topics-modal").modal("show")}),$("#page-topics-filter-submit").on("click",(function(t){t.preventDefault();let e=$("#page-topics-filter-form").form("get value","pageTopicList");!function(t){if($(".transcript").hasClass("topic-filter-active")){let e=$("#current-topic-filter").attr("data-filter");if(e===t.value)return;$(`mark.bookmark-selected-text.${e}`).removeClass("show")}else $(".transcript").addClass("topic-filter-active");$(`mark.bookmark-selected-text.${t.value}`).addClass("show"),$("#current-topic-filter").html(`Topic Filter: <span class="red">${t.topic}</span>`),$("#current-topic-filter").attr("data-filter",t.value),$("#bookmark-dropdown-menu > span i.bookmark-icon").eq(0).removeClass("green").addClass("yellow"),$("#page-topics-modal").modal("hide")}({value:e,topic:$(`#page-topics-topic-list > [value='${e}']`).text()})})),$(".page-topics-filter-reset").on("click",(function(t){if(t.preventDefault(),$(".transcript").hasClass("topic-filter-active")){let t=$("#current-topic-filter").attr("data-filter");$(`mark.bookmark-selected-text.${t}`).removeClass("show")}$(".transcript").removeClass("topic-filter-active"),$("#page-topics-topic-list").dropdown("clear"),$("#current-topic-filter").html(`${Object(l.b)("label:topicfilter")}: None`),$("#current-topic-filter").attr("data-filter",""),$("#bookmark-dropdown-menu > span  i.bookmark-icon").eq(0).removeClass("yellow").addClass("green")})),void(p=!0);$("#bookmark-filter-wrapper").removeClass("hide")}class h{constructor(t,e){this.list=t,this.topics=new Map,this.topicsModified=!1,this.sharePid=e,this._initTopics()}_incrementTopic(t,e=!1){let a=this.topics.size,n=t.value;if(this.topics.has(n)){let t=this.topics.get(n);t.count+=1,this.topics.set(n,t)}else t.count=1,this.topics.set(n,t),this.topicsModified=!0;0!==a||e||d()}_decrementTopic(t){let e=t.value;if(!this.topics.has(e))return;let a=this.topics.get(e);1===a.count?(this.topics.delete(e),this.topicsModified=!0):(a.count-=1,this.topics.set(e,a)),0===this.topics.size&&$("#bookmark-filter-wrapper").addClass("hide")}_initTopics(){this.list.forEach(t=>{ie("loaded",t,this.sharePid),t.annotation.selectedText&&t.annotation.topicList&&t.annotation.topicList.length>0&&t.annotation.topicList.forEach(t=>{this._incrementTopic(t,!0)})}),this.topicsModified=!0}_invalidateBmList(){let t=Object(r.a)("bmList");t&&(t.lastBuildDate=0,Object(r.c)("bmList",t))}getTopics(){return this.topics}get topicRefreshNeeded(){return this.topicsModified}set topicRefreshNeeded(t){this.topicsModified=t}getCreationDate(t){let e=this.list.find(e=>!(!e.annotation.aid||e.annotation.aid!==t));return e?e.creationDate:e}getItem(t,e){let a=parseInt(t.substr(1),10);return this.list.filter(t=>t.pid===a).find(t=>e?t.annotation.aid?t.annotation.aid===e:t.annotation.creationDate==e:void 0===t.annotation.aid)}addItem(t,e,a,n){let o=n.rangeStart,i=parseInt(o.substr(1),10);if("number"==typeof e&&(e=function(t){let e=`${t}`,a=e.indexOf(".");if(a>-1){switch(e.substring(a+1).length){case 1:e=`${e}00`;break;case 2:e=`${e}0`}}return e}(e)),"new"===n.status){n.creationDate=a;let o={userId:t,paraKey:`${e}`,creationDate:`${a}`,pid:i,annotation:n};this.list.push(o),o.annotation.selectedText&&o.annotation.topicList&&o.annotation.topicList.forEach(t=>{this._incrementTopic(t)}),this._invalidateBmList(),ie("created",o,this.list.filter(t=>t.pid===i).length-1)}else{let t=`${e}`,o=`${a}`,i=this.list.findIndex(e=>e.paraKey===t&&e.creationDate===o);if(-1===i)throw new Error("localStore: addItem:update: bookmark to update not found in list");if(n.selectedText){let t=[],e=[];if(n.topicList){let e=n.topicList.reduce((t,e)=>`${t} ${e.value}`,"");e=e.trim(),t=e.split(" ")}if(this.list[i].annotation.topicList){let t=this.list[i].annotation.topicList.reduce((t,e)=>`${t} ${e.value}`,"");t=t.trim(),e=t.split(" ")}let a=c()(t,e),o=c()(e,t);a.forEach(t=>{let e=n.topicList.find(e=>e.value===t);this._incrementTopic(e)}),o.forEach(t=>{let e=this.list[i].annotation.topicList.find(e=>e.value===t);this._decrementTopic(e)})}this.list[i].annotation=n,ie("updated",this.list[i])}}deleteItem(t,e,a){"string"!=typeof e&&(e=`${e}`),"string"!=typeof a&&(a=`${a}`);let n=this.list.findIndex(n=>n.userId===t&&n.paraKey===e&&n.creationDate===a),o=!1;if(n>-1){let t=this.list[n],e=t.pid;this.list[n].annotation.topicList&&this.list[n].annotation.topicList.forEach(t=>{o=this._decrementTopic(t)||o}),this.list.splice(n,1),this._invalidateBmList();let a=this.list.filter(t=>t.pid===e);return ie("deleted",t,a.length),{remainingCount:a.length,modified:o}}return{remainingCount:null,modified:o}}itemCount(t,e){if(!e)return 0;let a=parseInt(t.substr(1),10);return this.list.filter(t=>t.pid===a).reduce((t,a)=>(a.annotation.aid&&a.annotation.aid!==e&&(t+=1),t),0)}}var u=a(12),f=a(1),m=a.n(f),b=a(28),g=a.n(b),k={};var v={fetchTopics:function(){const t=Object(i.b)();let e=Object(r.a)("bmTopics");return new Promise((a,n)=>{if(e&&e.lastFetchDate+72e5>Date.now())return void a(e);let i=k.sourceId.toString(10);Object(o.a)(t.userId,i).then(t=>{let e={lastFetchDate:Date.now(),topics:t};Object(r.c)("bmTopics",e),a(e)}).catch(t=>{console.error("Error fetching topicList: ",t),n(t)})})},deleteAnnotation:function(t,e){const a=Object(i.b)();return new Promise(async(o,i)=>{const r=k.keyInfo.genParagraphKey(t);try{await Object(n.a)(a.userId,r,e);o(Yt.deleteItem(a.userId,r,e).remaining)}catch(t){i(t)}})},postAnnotation:function(t,e,a=!0){const o=Object(i.b)();let r,s=Date.now(),c=g()(t);c.modified&&delete c.modified,c.selectedText&&(r=c.selectedText.wrap,delete c.selectedText.wrap,"string"!=typeof c.selectedText&&(c.selectedText.aid||(c.selectedText.aid=s.toString(10)),c.selectedText=JSON.stringify(c.selectedText)));let p=c.creationDate?c.creationDate:s;return e||(e=k.keyInfo.genParagraphKey(c.rangeStart)),Object(n.d)(o.userId,e,p,c).then(t=>{if(a){c.selectedText&&(c.selectedText=JSON.parse(c.selectedText),r&&(c.selectedText.wrap=r));try{Yt.addItem(o.userId,e,p,c)}catch(t){console.error(`Error saving annotation to localStore: ${t}`)}}}).catch(t=>{console.error(`Error saving annotation: ${t}`),m.a.error(Object(l.b)("error:e1"))}),p}},x=a(112),y=a.n(x),I=a(47),w=a.n(I),C=a(8),O=a(113),j=a.n(O),S=a(37),T=a.n(S),L=a(23),K=a.n(L),D=a(9),E=a.n(D),q=a(25);let P={},N={};function A(t){P=t,$("form[name='emailshare']").on("submit",(async function(t){t.preventDefault();const e=Object(i.b)();if(!e)return m.a.warning(Object(l.b)("annotate:m14")),void $(".email-share-dialog-wrapper").addClass("hide");let a=$("#email-share-form").form("get values");if(0!==a.mailList.length||0!==a.emailAddresses.length){if(N.to="",a.mailList.length>0){let t=function(t){let e=[],a={};return t.forEach(t=>{let[n,o,i]=t.split(":");e.push(n),a[n]={first:""===o?"No First Name":o,last:""===i?"No Last Name":i}}),{to:e.join(","),variables:JSON.stringify(a)}}(a.mailList);N.to=t.to,N.variables=t.variables}a.emailAddresses.length>0&&(N.to.length>0?N.to=`${N.to}, ${a.emailAddresses}`:N.to=a.emailAddresses),N.senderName=e.name,N.senderEmail=e.email,N.sid=P.sid,a.emailMessage&&(N.message=function(t){let e=(t=(t=t.replace(/\n/g,"@@")).replace(/@@*/g,"@@")).split("@@");return t=e.reduce((t,e)=>`${t}<p>${Object(u.a)(e)}</p>`,"")}(a.emailMessage)),$(".email-share-dialog-wrapper").addClass("hide");try{"success"===await Object(q.c)(N)?m.a.info(Object(l.b)("action:emailsent")):m.a.info(response.data.message)}catch(t){m.a.error(t)}}else m.a.info(Object(l.b)("error:e9"))})),$("form[name='emailshare'] .email-share-cancel").on("click",(function(t){t.preventDefault(),$(".email-share-dialog-wrapper").addClass("hide")}))}function M(t){return new Promise((e,a)=>{let n=Object(l.b)("label:listnames",!0),o=Object(l.b)("label:selectaddress",!0);Promise.all([n,o]).then(a=>{e(`\n        <label>${a[0]}</label>\n        <select name="mailList" id="maillist-address-list" multiple="" class="search ui dropdown">\n          <option value="">${a[1]}</option>\n          ${t.map(t=>`${function(t){return`<option value="${t.address}:${t.first}:${t.last}">${t.first} ${t.last}</option>`}(t)}`).join("")}\n        </select>\n      `)})})}let B=!1;var U=a(114),_=a.n(U),R=new Map;function F(t){var e,a=new _.a(t);return(e=a).on("success",t=>{t.text.indexOf("tocbook")>-1?($(".toc.modal > .message").html(`<p>${Object(l.b)("clip:url")}</p>`),setTimeout(()=>{$(".toc.modal > .message > p").remove()},2e3)):m.a.info(Object(l.b)("clip:link")),t.clearSelection()}),e.on("error",()=>{m.a.info(Object(l.b)("error:e3"))}),a}var z=function(t){let e=R.get(t);return e||(e=F(t),R.set(t,e)),e};let H,W={},J=!1;function Q(t){return t&&0!==t.length?`\n    <div class="ui horizontal bulleted list">\n      ${t.map(t=>`\n        <div class="item">\n          <em>${"object"==typeof t?t.topic:t}</em>\n        </div>\n      `).join("")}\n    </div>\n  `:Object(l.b)("annotate:m13")}function G(t,e,a,n){return`\n    <div class="ui list">\n      <div class="item">\n        <i class="bookmark icon"></i>\n        <div class="content">\n          <div class="header">\n            ${n}: ${t}\n          </div>\n          <div class="list">\n            ${e.map(t=>`\n              ${function(t,e=[]){let a;t.topicList||(t.topicList=[]);let n=t.topicList.map(t=>t.value);return e.length>0&&(a=j()(n,e)),0===e.length||a.length>0?`\n      <div class="item"> \x3c!-- item: ${t.rangeStart}/${t.rangeEnd} --\x3e\n        <i class="right triangle icon"></i>\n        <div class="content">\n          <div class="header">\n            ${Q(t.topicList)}\n          </div>\n          <div class="description">\n            <button class="annotation-item ui icon basic button" data-range="${t.rangeStart}/${t.rangeEnd}" data-aid="${t.aid}" data-creationDate="${t.creationDate}" >\n              <i class="share square icon"></i>\n              ${t.Comment?t.Comment:Object(l.b)("annotate:m7")}\n            </button>\n            \x3c!--\n            <a title="Click to share" data-aid="${t.aid}" data-creationDate="${t.creationDate}" class="annotation-item" data-range="${t.rangeStart}/${t.rangeEnd}">\n              ${t.Comment?t.Comment:Object(l.b)("annotate:m7")}\n            </a>\n            --\x3e\n          </div>\n        </div>\n      </div> \x3c!-- item: ${t.rangeStart}/${t.rangeEnd} --\x3e\n    `:`\x3c!-- annotation filtered: ${e.join(" ")} --\x3e`}(t,a)}\n            `).join("")}\n          </div>\n        </div>\n      </div>\n    </div>\n `}function V(t,e,a,n){let o,i=t[e][a];return o=i[0].selectedText?n.length>0?`${i[0].selectedText.url}?tnav=${i[0].rangeStart}&topic=${n}`:`${i[0].selectedText.url}?bkmk=${i[0].rangeStart}`:n.length>0?`${"integration"===W.env?W.url_prefix:""}${W.keyInfo.getUrl(e)}?tnav=${i[0].rangeStart}&topic=${n}`:`${"integration"===W.env?W.url_prefix:""}${W.keyInfo.getUrl(e)}?bkmk=${i[0].rangeStart}`,o}function Y(t,e,a,n){let o=Object.keys(e),i=o.indexOf("lastFetchDate");if(i>-1&&o.splice(i,1),i=o.indexOf(t),-1===i)return Promise.reject("bookmark not found");let r=function(t,e,a,n,o){if(t>e.length)return Promise.resolve(null);let i,r,s=!1;t:for(i=t;i<e.length;i++){let t=n[e[i]];for(r in t)for(let e=0;e<t[r].length;e++){if(!a||0===a.length){s=!0;break t}if(T()(a,t[r][e].topicList||[],(t,e)=>t===e.value).length>0){s=!0;break t}}}return new Promise(t=>{if(s){let a=e[i],s=V(n,a,r,o);if(s)return void t(s);t(null)}else t(null)})}(i+1,o,a?a.modal.topics:a,e,n),s=function(t,e,a,n,o){if(t<0)return Promise.resolve(null);let i,r,s=!1;t:for(i=t;i>=0;i--){let t=n[e[i]];for(r in t)for(let e=0;e<t[r].length;e++){if(!a||0===a.length){s=!0;break t}if(T()(a,t[r][e].topicList||[],(t,e)=>t===e.value).length>0){s=!0;break t}}}return new Promise(t=>{if(s){let a=e[i];t(V(n,a,r,o))}else t(null)})}(i-1,o,a?a.modal.topics:a,e,n);return Promise.all([s,r])}function Z(t,e,a,n,o){let i,r,s=[];n&&n.modal.filter&&(s=n.modal.topics,r=Q(n.modal.fullTopic)),i=(parseInt(e.substr(1),10)+1).toString(10);let c=a[t][i];if(!c)return!1;Object(l.b)("label:para",!0).then(t=>{let a=G(e,c,s,t);$("#bookmark-content").html(a)}),r?($("#filter-topics-section").removeClass("hide"),$(".bookmark-navigator-filter").html(r)):$("#filter-topics-section").addClass("hide"),$(".bookmark-navigator-header-book").text($("#book-title").text());let p,d,h=Object.keys(a[t]),u=h.indexOf(i);if(p=function(t,e,a,n){if(t<1)return null;if(0===n.length)return`p${(parseInt(e[t-1],10)-1).toString(10)}`;for(let o=t-1;o>=0;o--){let t=a[e[o]];for(let a=0;a<t.length;a++)if(t[a].topicList&&t[a].topicList.length>0){if(T()(t[a].topicList,n,(t,e)=>t.value===e).length>0)return`p${(parseInt(e[o],10)-1).toString(10)}`}}return null}(u,h,a[t],s),d=function(t,e,a,n){if(t+1===e.length)return null;if(0===n.length)return`p${(parseInt(e[t+1],10)-1).toString(10)}`;for(let o=t+1;o<e.length;o++){let t=a[e[o]];for(let a=0;a<t.length;a++)if(t[a].topicList&&t[a].topicList.length>0){if(T()(t[a].topicList,n,(t,e)=>t.value===e).length>0)return`p${(parseInt(e[o],10)-1).toString(10)}`}}return null}(u,h,a[t],s),$(".bookmark-navigator .current-bookmark").attr("data-pid",`${e}`),Object(l.b)("action:prev",!0).then(t=>{p?($(".bookmark-navigator .previous-bookmark").attr("data-pid",p),$(".bookmark-navigator .previous-bookmark").removeClass("inactive"),$(".bookmark-navigator .previous-bookmark").html(`<i class="up arrow icon"></i> ${t} (${p})`)):($(".bookmark-navigator .previous-bookmark").addClass("inactive"),$(".bookmark-navigator .previous-bookmark").html(`<i class='up arrow icon'></i>${t}`))}),Object(l.b)("action:next",!0).then(t=>{d?($(".bookmark-navigator .next-bookmark").attr("data-pid",d),$(".bookmark-navigator .next-bookmark").removeClass("inactive"),$(".bookmark-navigator .next-bookmark").html(`<i class="down arrow icon"></i> ${t} (${d})`)):($(".bookmark-navigator .next-bookmark").addClass("inactive"),$(".bookmark-navigator .next-bookmark").html(`<i class='down arrow icon'></i> ${t}`))}),"topic"===o){let{rangeStart:t,rangeEnd:e,creationDate:a}=c[0];!function(t,e,a,n){let o=parseInt(e.substr(1),10),i=parseInt(a.substr(1),10);$(".topic-navigator").unwrap(),$(".topic-navigator").removeClass("topic-navigator");for(let t=o;t<=i;t++){let e=$(`#p${t}`);e.parent().is("blockquote")?e.parent().addClass("topic-navigator"):e.addClass("topic-navigator")}$(".topic-navigator").wrapAll("<div class='navigator-highlight' />")}(0,t,e)}return!0}function X(t,e,a){let n,o;"bookmark"===a?(n=Object(r.a)("bmList"),o=Object(r.a)("bmModal")):(n=Object(r.a)("topicList"),o=null),Z(H,t,n,o,a)}function tt(){let t=$(".selected-annotation");if(t.length>0){$(".selected-annotation-wrapper > .header").remove(),t.unwrap().removeClass("selected-annotation"),$(".bookmark-selected-text.show").removeClass("show");let e=$("div.transcript.ui.disable-selection:not(.user)");e.length>0&&e.removeClass("disable-selection")}}function et(t,e){E()(document.getElementById(t),{align:{top:.2}},t=>{})}function at(t){J||($(".transcript").on("click",".selected-annotation-wrapper .share-annotation",(function(t){t.preventDefault();let e,a,n,o=$(".selected-annotation-wrapper mark.show");if($(this).hasClass("close"))return void tt();if(e=Object(i.b)(),!e)return void m.a.info(Object(l.b)("annotate:m14"));let r,s=$(".selected-annotation-wrapper i[data-clipboard-text]").attr("data-clipboard-text"),c=s.indexOf("undefined");if($(this).hasClass("facebook"))r="facebook";else if($(this).hasClass("envelope"))r="email";else if($(this).hasClass("linkify"))return c>-1?void m.a.error(Object(l.b)("error:e5")):void(r="clipboard");a=$(".selected-annotation-wrapper p").attr("id"),0===o.length?(n=$(".selected-annotation-wrapper > p").text(),n=function(t,e){let a="email"===t?"@@":"\n\n",n=(e=(e=(e=e.replace(/[^\x20-\x7E]/g," ")).replace(/ {2,}/g," ")).replace(/\(p\d*\)/g,t=>`${a}${t}`)).split(a);return 0===n[0].length&&n.shift(),e="email"===t?n.reduce((t,e)=>`${t}\n<p>${e}</p>`,""):n.join("\n")}(r,n)):n=o.text().replace(/\n/," ");let p=`~ ${$("#src-title").text()}: ${$("#book-title").text()}`;if("facebook"===r){if(c>-1)return void m.a.error(Object(l.b)("error:e5"));let t={method:"share",hashtag:"#christmind",quote:`${n}\n${p}`,href:s};FB.ui(t,(function(){}))}else if("email"===r){if(c>-1)return void m.a.error(Object(l.b)("error:e5"));!async function(t,e,a){const n=Object(i.b)();if(N={citation:e,quote:t,url:a},$(".hide.email-share-dialog-wrapper").removeClass("hide"),!B)try{$(".email-share-loader").addClass("active");let t=await Object(q.a)(n.userId),e=await M(t);$("#maillist-select").html(e),$("#maillist-address-list.dropdown").dropdown(),B=!0,$(".email-share-loader").removeClass("active")}catch(t){m.a.error(`${Object(l.b)("error:e10")}: ${t}`)}}(n,p,s)}})),J=!0)}function nt(t,e){$(".bookmark-navigator .previous-bookmark").on("click",(function(e){e.preventDefault(),tt();let a=$(this).attr("data-pid");E()(document.getElementById(a),{align:{top:.2}},t=>{}),X(a,0,t)})),$(".bookmark-navigator .next-bookmark").on("click",(function(e){e.preventDefault(),tt();let a=$(this).attr("data-pid");E()(document.getElementById(a),{align:{top:.2}},t=>{}),X(a,0,t)})),$(".bookmark-navigator .current-bookmark").on("click",(function(t){t.preventDefault();let e=$(this).attr("data-pid");E()(document.getElementById(e),{align:{top:.2}},t=>{})})),$(".bookmark-navigator .close-window").on("click",(function(a){a.preventDefault(),tt(),$(".bookmark-navigator-wrapper").addClass("hide-bookmark-navigator"),$(".transcript").removeClass("bookmark-navigator-active"),"topic"===t&&($(".topic-navigator").unwrap(),$(".topic-navigator").removeClass("topic-navigator")),"topic"===t&&Object(i.b)()&&de(!1,e)})),$(".bookmark-navigator").on("click",".annotation-item",(function(e){e.preventDefault();let a=Object(i.b)();if("topic"===t&&!a)return;tt(),a||(a={userId:"xxx"});let n,o=$(this).attr("data-aid"),r=$(this).attr("data-range").split("/"),s=r[0];"undefined"!==o?(n=$(`[data-annotation-id='${o}']`).attr("data-aid"),$(`[data-annotation-id="${n}"]`).addClass("show")):n=$(`#${s} > span.pnum`).attr("data-aid"),n||(n=$(this).attr("data-creationDate"));let c,p=`${location.origin}${location.pathname}?as=${s}:${n}:${a.userId}`,d=r.map(t=>parseInt(t.substr(1),10)),h=K()(d[0],d[1]+1);c="xxx"===a.userId?`\n        <h4 class="ui header">\n          <i title="${Object(l.b)("annotate:m11")}" class="red window close outline icon"></i>\n          <div class="content">\n            ${$(this).text()}\n          </div>\n        </h4>\n      `:l.a`
        <h4 class="ui header">
          <i title="${"action:fbshare"}" class="share-annotation facebook icon"></i>
          <i title="${"action:emailshare"}" class="share-annotation envelope outline icon"></i>
          <i data-clipboard-text="${p}" title="${"action:cp2clip"}" class="share-annotation linkify icon"></i>
          <div class="content">
            ${$(this).text()}
          </div>
        </h4>
      `;for(let t=0;t<h.length;t++)$(`#p${h[t]}`).addClass("selected-annotation");$(".selected-annotation").wrapAll("<div class='selected-annotation-wrapper ui raised segment'></div>"),$(".selected-annotation-wrapper").prepend(c),"xxx"!==a.userId&&z(".share-annotation.linkify")})),at()}function ot(t,e){W=e,function(t){W.keyInfo.getSourceId();let e=W.keyInfo.genPageKey().toString(10),a=Object(r.a)("bmList"),n=Object(r.a)("bmModal");a&&(H=e,Y(e,a,n,"").then(o=>{null!==o[0]?$(".bookmark-navigator .previous-page").attr({href:o[0]}):$(".bookmark-navigator .previous-page").addClass("inactive").removeAttr("href"),null!==o[1]?$(".bookmark-navigator .next-page").attr({href:o[1]}):$(".bookmark-navigator .next-page").addClass("inactive").removeAttr("href"),Z(e,t,a,n,"bookmark")?(nt("bookmark"),$(".transcript").addClass("bookmark-navigator-active"),$(".bookmark-navigator-wrapper").removeClass("hide-bookmark-navigator"),setTimeout(et,250,t,"bookmarkManager")):Object(l.b)("fragment:f1",!0).then(e=>{m.a.info(l.a`${e} ${t} ${"fragment:f2"}`)})}).catch(e=>{console.error(e),"bookmark not found"===e&&Object(l.b)("fragment:f1",!0).then(e=>{m.a.info(`${e} ${t} ${Object(l.b)("fragment:f2")}`)})}))}(t)}function it(t,e){W=e,function(t,e){W.keyInfo.getSourceId();let a=W.keyInfo.genPageKey().toString(10),n=Object(r.a)("topicList");if(n){let o=Object.keys(n[a]),i=n[a][o[0]][0].topicList.find(e=>e.value===t.topic);console.log("keys: %o, topiclist: %o",o,i),i&&$(".bookmark-navigator").prepend(`<h4 class="ui header"><div class="content">Topic: ${i.topic}</div></h4>`),H=a,Y(a,n,null,t.topic).then(o=>{null!==o[0]?$(".bookmark-navigator .previous-page").attr({href:o[0]}):$(".bookmark-navigator .previous-page").addClass("inactive").removeAttr("href"),null!==o[1]?$(".bookmark-navigator .next-page").attr({href:o[1]}):$(".bookmark-navigator .next-page").addClass("inactive").removeAttr("href"),Z(a,t.pid,n,null,"topic")?(nt("topic",e),$(".transcript").addClass("bookmark-navigator-active"),$(".bookmark-navigator-wrapper").removeClass("hide-bookmark-navigator"),setTimeout(et,250,t.pid,"bookmarkTopicManager")):Object(l.b)("fragment:f1",!0).then(t=>{m.a.info(l.a`${t} ${actualPid} ${"fragment:f2"}`)})}).catch(t=>{console.error(t),"bookmark not found"===t&&Object(l.b)("fragment:f1",!0).then(t=>{m.a.info(`${t} ${actualPid} ${Object(l.b)("fragment:f2")}`)})})}}(t,e)}var rt=a(68),st=a.n(rt),ct=a(69),lt=a.n(ct);let pt={};function dt(t,e,a,n){if(0===e.length)return`\n      <div class="bookmark-item item"> \x3c!-- ${t} --\x3e\n        <i class="bookmark icon"></i>\n        <div class="content">\n          <div class="header">\n            <a href="${a}?bkmk=${t}">${Object(l.b)("label:para")}: ${t}</a>\n          </div>\n        </div>\n      </div> \x3c!-- item: ${t} --\x3e\n    `;return`\n    <div class="${n.reduce((t,e)=>"object"==typeof e?`${t} ${e.value}`:`${t} ${e}`,"")} bookmark-item item"> \x3c!-- ${t} --\x3e\n      <i class="bookmark icon"></i>\n      <div class="content">\n        <div class="header">\n          <a href="${a}?bkmk=${t}">${Object(l.b)("label:para")}: ${t}</a>\n        </div>\n        <div class="list">\n          ${e.map(t=>{return`\n            <div class="item"> \x3c!-- item: ${t.rangeStart}/${t.rangeEnd} --\x3e\n              <i class="right triangle icon"></i>\n              <div class="content">\n                <div class="header">\n                  ${e=t.topicList,e&&0!==e.length?`\n    <div class="ui horizontal bulleted list">\n      ${e.map(t=>`\n        <div class="item">\n          <em>${"object"==typeof t?t.topic:t}</em>\n        </div>\n      `).join("")}\n    </div>\n  `:Object(l.b)("annotate:m13")}\n                </div>\n                <div class="description">\n                  ${t.Comment?t.Comment:Object(l.b)("annotate:m7")}\n                </div>\n              </div>\n            </div> \x3c!-- item: ${t.rangeStart}/${t.rangeEnd} --\x3e\n          `;var e}).join("")}\n        </div>\n      </div>\n    </div> \x3c!-- item: ${t} --\x3e\n  `}function ht(t){return`\n    ${t.map(t=>`\n      <div class="item"> \x3c!-- item: ${t.title} --\x3e\n        <i class="file icon"></i>\n        <div class="content">\n          <div class="header">\n            ${function(t){let e=`${t.title}`;return t.subTitle&&(e=`${e}: ${t.subTitle}`),e}(t)}\n          </div>\n          <div class="list">\n            ${function(t,e){let a="";for(let n in t)if(!n.startsWith("tpList")){a+=dt(`p${(parseInt(n,10)-1).toString(10)}`,t[n],e,t[`tpList${n}`])}return a}(t.bookmarks,t.url)}\n          </div>\n        </div>\n      </div>\n    `).join("")}\n  `}function ut(t){let e,a=!0,n=[],o=$(".cmi-bookmark-list").attr("data-lbd");if(o){if(o=parseInt(o,10),o===t.lastBuildDate)return;a=!1}$(".cmi-bookmark-list").attr("data-lbd",t.lastBuildDate);for(let e in t)"lastFetchDate"!==e&&"lastBuildDate"!==e&&n.push(pt.getPageInfo(e,t[e]));Promise.all(n).then(t=>{let{bookArray:n,topics:o}=function(t){let e={},a=[];t.forEach(t=>{e[t.bookId]||(e[t.bookId]={},e[t.bookId].bookId=t.bookId,e[t.bookId].bookTitle=t.bookTitle,t.subTitle&&(e[t.bookId].subTitle=t.subTitle),e[t.bookId].pages=[]);let a={pageKey:t.pageKey,title:t.title,url:t.url,bookmarks:t.data};t.subTitle&&(a.subTitle=t.subTitle),e[t.bookId].pages.push(a)}),t.forEach(t=>{e[t.bookId]&&(a.push(e[t.bookId]),delete e[t.bookId])});let n=[];a.forEach(t=>{t.pages.forEach(t=>{for(let e in t.bookmarks)if(t.bookmarks[e].length>0){let a=t.bookmarks[e].map(t=>t.topicList?t.topicList:[]),o=lt()(st()(a),(t,e)=>t.value===e.value);t.bookmarks[`tpList${e}`]=o,n.push(o)}})});let o=st()(n).sort((t,e)=>t.value<e.value?-1:t.value>e.value?1:0),i=lt()(o,(t,e)=>t.value===e.value);return{bookArray:a,topics:i}}(t);var i;e=0===(i=n).length?l.a`
      <h2 class="ui center aligned icon header">
        <i class="circular bookmark icon"></i>
        ${"bmlist:header"}
      </h2>
      <p>
        ${"bmlist:intro"}
      </p>
      <ul>
        <li>${"bmlist:item1"}</li>
        <li>${"bmlist:item2"}</li>
      </ul>
      <p>
        ${"bmlist:link"}
      </p>
    `:`\n    ${i.map(t=>`\n      <div data-bid="${t.bookId}" class="item"> \x3c!-- item: ${t.bookId} --\x3e\n        <div class="right floated content">\n          <div data-book="${t.bookId}" class="green ui small button">Open</div>\n        </div>\n        <i class="book icon"></i>\n        <div class="content">\n          <div class="${t.bookId}-header header">\n            ${t.bookTitle}\n          </div>\n          <div id="${t.bookId}-list" class="hide-bookmarks list">\n            ${ht(t.pages)}\n          </div>\n        </div>\n      </div> \x3c!-- item: ${t.bookId} --\x3e\n    `).join("")}\n  `,$(".cmi-bookmark-list").html(e);let s=function(t){return`\n    <label>Filter Topic(s)</label>\n    <select name="topicList" id="bookmark-topic-list" multiple="" class="search ui dropdown">\n      <option value="">${Object(l.b)("label:selecttopic")}</option>\n      ${t.map(t=>`${function(t){return"object"==typeof t?`<option value="${t.value}">${t.topic}</option>`:`<option value="${t}">${t}</option>`}(t)}`).join("")}\n    </select>\n  `}(o);$("#bookmark-modal-topic-select").html(s),$("#bookmark-topic-list").dropdown(),$("#bookmark-modal-loading").removeClass("active").addClass("disabled");let c=Object(r.a)("bmModal",{modal:{filter:!1}});$("[data-bid]").each((function(){let t={},e=$(this).data("bid");t.count=$(`[data-bid="${e}"] .bookmark-item`).length,t.header=$(`.${e}-header`).text().trim(),$(`.${e}-header`).text(`${t.header} (${t.count})`),c[e]=t})),a&&(Object(r.c)("bmModal",c),$(".cmi-bookmark-list").on("click","[data-book]",(function(t){t.stopPropagation();let e=$(this).attr("data-book"),a=$(`#${e}-list`);a.hasClass("hide-bookmarks")?(a.removeClass("hide-bookmarks"),$(this).text("Close").removeClass("green").addClass("yellow")):(a.removeClass("yellow").addClass("green hide-bookmarks"),$(this).text("Open").removeClass("yellow").addClass("green"))})),$(".bookmark-filter-submit").on("click",(function(t,e){t.preventDefault();let a=$("#bookmark-filter-form").form("get value","topicList"),n=new RegExp(`\\b(${a.join("|")})\\b`);if(0===a.length)return;$(".cmi-bookmark-list .bookmark-item").each((function(){$(this).attr("class").match(n)?$(this).removeClass("hide-bookmark-item"):$(this).addClass("hide-bookmark-item")}));let o=Object(r.a)("bmModal",{modal:{filter:!1}}),i=a.map(t=>({value:t,topic:$(`#bookmark-topic-list > [value='${t}']`).text()}));e||(o.modal.filter=!0,o.modal.topics=a,o.modal.fullTopic=i,Object(r.c)("bmModal",o)),$("[data-bid]").each((function(){let t=$(this).data("bid"),e=$(`[data-bid="${t}"] .bookmark-item.hide-bookmark-item`).length,a=o[t].count-e;$(`.${t}-header`).html(`${o[t].header} (<span class="bookmark-filter-color">${a}</span>/${o[t].count})`)}))})),$(".bookmark-filter-reset").on("click",(function(t){t.preventDefault(),$("#bookmark-filter-form").form("clear"),$(".cmi-bookmark-list .hide-bookmark-item.bookmark-item").each((function(){$(this).removeClass("hide-bookmark-item")}));let e=Object(r.a)("bmModal",{modal:{filter:!1}});$("[data-bid]").each((function(){let t=$(this).data("bid");$(`.${t}-header`).text(`${e[t].header} (${e[t].count})`)})),e.modal.filter=!1,delete e.modal.topics,Object(r.c)("bmModal",e)})),function(){let{modal:t}=Object(r.a)("bmModal",{modal:{filter:!1}}),e=$("#bookmark-filter-form");console.log("modal: ",t),t.filter&&(e.form("set value","topicList",t.topics),$(".bookmark-filter-submit").trigger("click",{init:!0}))}())}).catch(t=>{console.error(t)})}async function ft(t){const e=Object(i.b)();let a=Object(r.a)("bmList",{modal:{filter:!1}});if(a){let t=a.lastFetchDate+288e5;if(Date.now()<t&&a.lastBuildDate>0)return void ut(a)}try{ut(function(t){let e={};return t.forEach(t=>{let[a,n]=t.paraKey.split(".");n=parseInt(n,10)+"",e[a]||(e[a]={}),e[a][n]||(e[a][n]=[]),e[a][n].push(t.annotation)}),e.lastFetchDate=Date.now(),e.lastBuildDate=Date.now(),Object(r.c)("bmList",e),e}(await Object(n.c)(e.userId,t)))}catch(t){console.error(t),m.a.error(Object(l.b)("error:e4"))}}function mt(){$(".bookmark.ui.modal").modal({dimmerSettings:{opacity:.5},autofocus:!1,centered:!0,duration:400,inverted:!0,observeChanges:!0,transition:"horizontal flip",onShow:function(){!function(){const{sourceId:t}=pt.keyInfo.getKeyInfo();ft(t)}()},onVisible:function(){},onHidden:function(){}}),$(".bookmark-modal-open").on("click",t=>{t.preventDefault(),$(".bookmark.ui.modal").modal("show")})}var bt=function(t){pt=t,mt()},gt=a(297);let $t={};function kt(){return l.a`
    <form name="annotation" id="annotation-form" class="ui form">
      <input class="hidden-field" type="text" readonly="" name="status">
      <input class="hidden-field" type="text" readonly="" name="creationDate">
      <input class="hidden-field" type="text" name="aid" readonly>
      <input class="hidden-field" type="text" readonly="" name="rangeStart">
      <div class="fields">
        <div class="three wide field">
          <input id="rangeEnd" type="text" name="rangeEnd" maxlength="4" placeholder="${"label:end"}">
        </div>
        <div id="available-topics" class="twelve wide field"></div>
        </div>
      </div>
      <div class="field">
        <input type="text" name="Comment" placeholder="${"label:comment"}">
      </div>
      <div class="field">
        <input type="text" name="newTopics" placeholder="${"label:newtopic"}">
      </div>
      <div class="field">
        <textarea name="Note" placeholder="${"label:notes"}" rows="3"></textarea>
      </div>
      <div class="fields">
        <button class="annotation-submit ui green button" type="submit">${"action:submit"}</button>
        <button class="annotation-cancel ui red basic button">${"action:cancel"}</button>
        <button class="annotation-share ui green disabled basic button">${"action:share"}</button>
        <button class="annotation-note ui blue basic button">${"label:links"}</button>
        <div class="twelve wide field">
          <button class="annotation-delete ui red disabled right floated button">${"action:delete"}</button>
        </div>
      </div>
    </form>
    <div class="note-and-links hide">
      <table id="bookmark-link-table" class="ui selectable celled table">
        <thead>
          <tr>
            <th></th>
            <th></th>
            <th>${"label:linkref"}</th>
            <th>${"label:link"}</th>
            <th></th>
          </tr>
        </thead>
        <tbody id="bookmark-link-list">
        </tbody>
      </table>
      <form name="linkForm" id="link-form" class="ui form">
        <div class="fields">
          <div class="ten wide field">
            <input required type="text" placeholder="${"label:linknote"}" name="reference">
          </div>
          <div class="five wide field">
            <input required type="text" placeholder="${"label:link"}" name="link">
          </div>
          <button title="add or update" data-index="-1" type="submit" class="green ui icon button">
            <i class="plus circle icon"></i>
          </button>
          <button title="clear fields" type="reset" class="yellow ui icon button">
            <i class="minus circle icon"></i>
          </button>
        </div>
      </form>
    </div>
  `}let vt=[];function xt(t){return vt[t]}function yt(t){$("#link-form [type='submit']").data("index",t)}function It(t){let e=JSON.parse(t),a=`${e.desc.source}:${e.desc.book}:${e.desc.unit}`;return a=e.desc.question?`${a}:${e.desc.question}:${e.desc.pid}`:`${a}:${e.desc.pid}`,a}function wt(){$(".transcript").on("submit","#link-form",(function(t){t.preventDefault();let e=function(){let t=$("#link-form [type='submit']").data("index");return parseInt(t,10)}(),a=-1===e?"new":"edit",n=$("#link-form").form("get values");if(!function(t,e){let a,n=$t.keyInfo.genParagraphKey(t);try{a=JSON.parse(e)}catch(t){return m.a.error(Object(l.b)("annotate:m3")),!1}return a.aid&&a.desc&&a.key&&a.userId?a.key!==n||(m.a.error(Object(l.b)("annotate:m5")),!1):(m.a.error(Object(l.b)("annotate:m4")),!1)}($(".annotate-wrapper p.cmiTranPara").attr("id"),n.link))return;let o=It(n.link);if("new"===a){vt.push({reference:n.reference,link:n.link,deleted:!1});let t=function(t,e){return l.a`
    <tr data-index="${e}">
      <td title="${"action:delete"}" class="delete-link-item"><i class="red trash alternate icon"></i></td>
      <td title="${"action:edit"}" class="edit-link-item"><i class="yellow pencil alternate icon"></i></td>
      <td data-name="reference">${t.reference}</td>
      <td data-name="link">${t.link}</td>
      <td title="${"action:follow"}" class="follow-link-item"><i class="green share icon"></i></td>
    </tr>
  `}({reference:n.reference,link:o},vt.length-1);$("#bookmark-link-list").append(t)}else vt[e]={reference:n.reference,link:n.link,deleted:!1},$(`tr[data-index="${e}"] > td[data-name="reference"]`).text(vt[e].reference),$(`tr[data-index="${e}"] > td[data-name="link"]`).text(o),yt(-1);$("#link-form").form("clear")})),$(".transcript").on("click","#bookmark-link-list td.delete-link-item",(function(t){t.stopPropagation(),t.preventDefault();let e=$(this).parent(),a=parseInt(e.attr("data-index"),10);vt[a].deleted=!0,e.remove()})),$(".transcript").on("click","#bookmark-link-list td.edit-link-item",(function(t){t.stopPropagation(),t.preventDefault();let e=parseInt($(this).parent().attr("data-index"),10);$("#link-form").form("set values",vt[e]),yt(e)}))}const Ct='\n  <div class="annotate-wrapper ui raised segment"></div>';function Ot(t){return t&&0!==t.length?`\n    ${t.map(t=>`\n      <div class="item">\n        <em>${t.topic}</em>\n      </div>\n    `).join("")}\n  `:`\n      <div class="item">\n        <em>${Object(l.b)("annotate:m6")}</em>\n      </div>\n    `}function jt(t){let e=[];return t.Note&&e.push("N"),t.links&&e.push(`L${t.links.length}`),0===e.length?'\n      <div class="item">\n        <i class="bookmark outline icon"></i>\n      </div>\n    ':`\n    ${e.map(t=>`\n      <div class="item">\n        ${function(t){let e;if("N"===t)e="<i class='align justify icon'></i>";else if(t.startsWith("L")){let a=t.substr(1);e=`<i class="linkify icon"></i>[${a}]`}return`${e}`}(t)}\n      </div>\n    `).join("")}\n  `}function St(t){return t||Object(l.b)("annotate:m7")}function Tt(t,e,a){let n=$("#annotation-form");$("#link-form");if(vt=[],a){let t=[];if(a.topicList&&(t=a.topicList.map(t=>t.value)),a.links){vt=a.links;let t=`\n    ${vt.map((t,e)=>l.a`
      <tr data-index="${e}">
        <td title="${"action:delete"}" class="delete-link-item"><i class="red trash alternate icon"></i></td>
        <td title="${"action:edit"}" class="edit-link-item"><i class="yellow pencil alternate icon"></i></td>
        <td data-name="reference">${t.reference}</td>
        <td data-name="link">${It(t.link)}</td>
        <td title="${"action:follow"}" class="follow-link-item"><i class="green share icon"></i></td>
      </tr>
    `).join("")}\n  `;$("#bookmark-link-list").html(t)}n.form("set values",{status:"update",rangeStart:a.rangeStart,rangeEnd:a.rangeEnd,aid:a.aid,creationDate:a.creationDate,Comment:a.Comment,Note:a.Note,topicList:t})}else n.form("set values",{status:"new",rangeStart:t,rangeEnd:t,aid:e});document.getElementById("rangeEnd").focus()}function Lt(){return $("#annotation-form").form("get values")}function Kt(t){let e=$(".transcript .annotation-edit");if(e.length>0){let a=e.first(1).attr("id");return t!==a&&m.a.info(l.a`${"annotate:m8"} ${a}. ${"annotate:m9"}`),!0}return!1}function Dt(){return!!$(".transcript").hasClass("bookmark-navigator-active")&&(m.a.info(Object(l.b)("annotate:m10")),!0)}function Et(t,e,a){let n=parseInt(a.rangeStart.substr(1),10),o=parseInt(a.rangeEnd.substr(1),10);if(n!==o){let t=K()(n,o+1);for(let e=0;e<t.length;e++)$(`#p${t[e]}`).addClass("annotation-edit")}else $(`#${t}`).addClass("annotation-edit");Nt(),$(".annotation-edit").wrapAll(Ct),$(".annotate-wrapper").prepend(kt()),$(".annotation-delete.disabled").removeClass("disabled"),$(".annotation-share.disabled").removeClass("disabled"),Bt(t,e,a)}function qt(t,e){let a=$t.keyInfo.genParagraphKey(t),n=$t.keyInfo.describeKey(a),o={userId:Object(i.b)().userId,key:a,aid:e,desc:n};return JSON.stringify(o)}function Pt(){let t=$("div.transcript.ui.disable-selection:not(.user)");t.length>0&&t.removeClass("disable-selection")}function Nt(){let t=$("div.transcript.ui");t.hasClass("disable-selection")||t.addClass("disable-selection")}function At(t){$t=t||Zt,$(".transcript").on("submit","#annotation-form",(function(t){t.preventDefault(),Pt();let e=Lt();if(e.topicList.length>0){let t=e.topicList.map(t=>({value:t,topic:$(`#annotation-topic-list > [value='${t}']`).text()}));e.topicList=t}Mt(),$(`[data-annotation-id="${e.aid}"]`).removeClass("show"),$(".transcript .annotation-edit").hasClass("note-style-bookmark")&&(e.bookTitle=$("#book-title").text());let a=vt.filter(t=>!1===t.deleted);a.length>0?e.links=a:vt.filter(t=>!0===t.deleted).length>0&&e.creationDate.length>0&&$(`i[data-link-aid="${e.creationDate}"]`).remove(),he.submit(e),$(".transcript .annotation-edit").removeClass("annotation-edit annotation-note")})),$(".transcript").on("click","#annotation-form .annotation-cancel",(function(t){t.preventDefault(),Pt();let e=Lt();Mt(),$(`[data-annotation-id="${e.aid}"]`).removeClass("show"),he.cancel(e),$(".transcript .annotation-edit").removeClass("annotation-edit")})),$(".transcript").on("click","#annotation-form .annotation-share",(function(t){t.preventDefault();let e=Lt();Mt(),$(`[data-annotation-id="${e.aid}"]`).removeClass("show"),$(".transcript .annotation-edit").removeClass("annotation-edit");let a=Object(i.b)();a||(a={userId:"xxx"});let n,o=e.aid,r=[e.rangeStart,e.rangeEnd],s=r.map(t=>parseInt(t.substr(1),10)),c=r[0];o.length>0?(n=$(`[data-annotation-id="${o}"]`).attr("data-aid"),$(`[data-annotation-id="${o}"]`).addClass("show"),n||(n=Yt.getCreationDate(o),$(`[data-annotation-id="${o}"]`).attr("data-aid",n))):n=$(`#${c} > span.pnum`).attr("data-aid");let p,d=`${location.origin}${location.pathname}?as=${c}:${n}:${a.userId}`,h=K()(s[0],s[1]+1);p="xxx"===a.userId?`\n        <h4 class="ui left floated header">\n          <i title="${Object(l.b)("annotate:m11")}" class="red window close outline icon"></i>\n          <div class="content">\n            ${e.Comment}\n          </div>\n        </h4>\n        <h4 class="ui right floated header">\n          <i title="${Object(l.b)("action:closewin")}" class="share-annotation window close icon"></i>\n        </h4>\n      `:`\n        <h4 class="ui left floated header">\n          <i title="${Object(l.b)("action:fbshare")}" class="share-annotation facebook icon"></i>\n          <i title="${Object(l.b)("action:emailshare")}" class="share-annotation envelope outline icon"></i>\n          <i data-clipboard-text="${d}" title="${Object(l.b)("action:cp2clip")}" class="share-annotation linkify icon"></i>\n          <div class="content">\n            ${e.Comment}\n          </div>\n        </h4>\n        <h4 class="ui right floated header">\n          <i title="${Object(l.b)("action:closewin")}" class="share-annotation window close icon"></i>\n        </h4>\n      `;for(let t=0;t<h.length;t++)0===t?$(`#p${h[t]}`).addClass("selected-annotation clearBoth"):$(`#p${h[t]}`).addClass("selected-annotation");$(".selected-annotation").wrapAll("<div class='selected-annotation-wrapper ui clearing raised segment'></div>"),$(".selected-annotation-wrapper").prepend(p),"xxx"!==a.userId&&z(".share-annotation.linkify")})),at(),$(".transcript").on("click","#annotation-form .annotation-delete",(function(t){t.preventDefault(),Pt();let e=Lt();Mt();let a=vt;a.length>0&&(e.links=a),he.delete(e),$(".transcript .annotation-edit").removeClass("annotation-edit")})),$(".transcript").on("click","[data-annotation-id]",(function(t){t.preventDefault();let e=$(this).attr("data-annotation-id"),a=$(this).parent("p").attr("id");void 0===a&&(a=$(this).parents("p").attr("id")),Kt(a)||Dt()||$(".transcript").hasClass("hide-bookmark-highlights")||$(".transcript").hasClass("topic-filter-active")&&!$(this).hasClass("show")||$(this).hasClass("shared")||($(this).popup("hide"),$(this).addClass("show"),Et(a,e,Yt.getItem(a,e).annotation))})),$(".transcript").on("click","p.cmiTranPara > span.pnum",(function(t){t.preventDefault();let e=$(this).parent("p").attr("id");if(Kt()||Dt())return;let a=Yt.getItem(e);a?Et(e,void 0,a.annotation):(Nt(),$(`#${e}`).addClass("annotation-edit annotation-note"),$(".annotation-edit").wrapAll(Ct),$(".annotate-wrapper").prepend(kt()),Bt(e))})),$(".transcript").on("mouseenter","[data-annotation-id]",(function(t){t.preventDefault();let e=$(this).attr("data-annotation-id"),a=$(this).parent("p").attr("id"),n=$(this).data("aid");if(!a)return void console.log("hoverHandler: pid not found");if($(".transcript").hasClass("hide-bookmark-highlights"))return void $(this).popup("hide").popup("destroy");if($(".transcript").hasClass("topic-filter-active")&&!$(this).hasClass("show"))return void $(this).popup("hide").popup("destroy");if($(`#${a}`).hasClass("annotation-edit"))return void $(`#${a} [data-annotation-id]`).each((function(){$(this).popup("hide").popup("destroy")}));if($(`#${a}`).hasClass("selected-annotation"))return void $(`#${a} [data-annotation-id]`).each((function(){$(this).popup("hide").popup("destroy")}));if($(this).hasClass("shared"))return void $(this).popup("hide").popup("destroy");let o=Yt.getItem(a,e);if(!o)return;let i=o.annotation,r=Ot(i.topicList),s=St(i.Comment),c=jt(i);$(".annotation-information .topic-list").html(r),$(".annotation-information .range").html(`${Object(l.b)("label:range")}: ${i.rangeStart}/${i.rangeEnd}`),$(".annotation-information .description").html(`${s}`),$(".annotation-information .extra").html(c),$(this).popup({popup:".annotation-information.popup",hoverable:!0}).popup("show");let p=qt(a,n);$("#popup-button").attr("data-clipboard-text",p),z("#popup-button"),$("#popup-button").focus()})),$(".transcript").on("click","#annotation-form .annotation-note",(function(t){t.preventDefault(),console.log("note button clicked");let e=$(".note-and-links");e.hasClass("hide")?e.removeClass("hide"):e.addClass("hide")})),wt(),$("body").on("click","#popup-button",(function(t){$("mark.visible").popup("hide"),$(".pnum.has-annotation.visible").popup("hide")})),$(".transcript").on("mouseenter",".has-annotation",(function(t){if(t.preventDefault(),$(".transcript").hasClass("hide-bookmark-highlights"))return void $(this).popup("hide").popup("destroy");let e=$(this).data("aid"),a=$(this).parent("p").attr("id"),n=Yt.getItem(a,e);if(!n)return;let o=n.annotation,i=Ot(o.topicList),r=St(o.Comment),s=jt(o);$(".annotation-information .topic-list").html(i),$(".annotation-information .range").html(`${Object(l.b)("label:range")}: ${o.rangeStart}/${o.rangeEnd}`),$(".annotation-information .description").html(`${r}`),$(".annotation-information .extra").html(s),$(this).popup({popup:".annotation-information.popup",hoverable:!0}).popup("show");let c=qt(a,e);$("#popup-button").attr("data-clipboard-text",c),z("#popup-button"),$("#popup-button").focus()}))}function Mt(){$(".annotate-wrapper > form").remove(),$(".annotate-wrapper > .note-and-links").remove(),$(".annotation-edit").unwrap()}function Bt(t,e,a){v.fetchTopics().then(n=>{let o=function(t){return`\n    <select name="topicList" id="annotation-topic-list" multiple="" class="search ui dropdown">\n      <option value="">${Object(l.b)("label:selecttopic")}</option>\n      ${t.map(t=>`${function(t){return"object"==typeof t?`<option value="${t.value}">${t.topic}</option>`:`<option value="${t}">${t}</option>`}(t)}`).join("")}\n    </select>\n  `}(n.topics);$("#available-topics").html(o),$("select.dropdown").dropdown(),Tt(t,e,a)}).catch(t=>{console.error("topic fetch error: ",t),m.a.error(`${Object(l.b)("annotate:m12")}: ${t}`)})}a(290);const Ut=a(107),_t=a(286),Rt=a(289);let Ft={},zt=[];function Ht(){let t,e=0;if(0!==zt.length)for(let a of zt){let n=Ft[a];t||(t=document.getElementById(n.pid)),Qt(n,t),Wt(n.id,e),e+=1}}function Wt(t,e){$(`[data-annotation-id="${t}"]`).addClass(["colorClass1","colorClass2","colorClass3","colorClass4","colorClass5","colorClass6"][e%6])}function Jt(t,e=0,a=null){let n=document.getElementById(t.pid);a&&a===t.pid?a&&zt.push(t.id):(Qt(t,n),Wt(t.id,e)),Ft[t.id]=t}function Qt(t,e=document.body){var a=t.id;if(t.target.source){for(var n=t.target.selector,o=0;o<n.length;o++){var i=n[o];switch(i.type){case"TextPositionSelector":if(0===document.querySelectorAll(`[data-annotation-id="${a}"]`).length){var r,s=document.createElement("mark");s.dataset.annotationId=a,t.aid&&(s.dataset.aid=t.aid),s.classList.add("bookmark-selected-text");try{r=Ut.toRange(e,i),t.wrap=Rt(s,r)}catch(e){return console.error("highlight catch bloc: err: %o",e),console.log("annotation: %o",t),!1}}}}return!0}}function Gt(t){$("div.transcript.ui").on("mouseup",(function(t){if(t.preventDefault(),!Object(i.b)())return;if($(this).hasClass("disable-selection"))return;if(document.getSelection().isCollapsed)return;let e=document.getSelection();0!==e.rangeCount&&(e.getRangeAt(0).collapsed||function(t){let e=t.getRangeAt(0);if("DIV"===e.commonAncestorContainer.nodeName)return void m.a.info(Object(l.b)("error:e8"));if("span"===e.startContainer.parentElement.localName)return void m.a.info(Object(l.b)("error:e6"));let a=e.startContainer;for(;"P"!==a.nodeName;)a=a.parentElement;let n=function(t,e=document.body){if(t.collapsed)return null;var a=Ut.fromRange(e,t);Object.assign(a,{type:"TextPositionSelector"});var n=_t.fromRange(e,t);return Object.assign(n,{type:"TextQuoteSelector"}),{type:"Annotation",title:$("#book-title").text(),url:location.pathname,pid:e.id,id:Object(gt.a)(),target:{type:"SpecificResource",source:location.href,selector:[a,n]}}}(e,a);if(n){let e=a.getElementsByTagName("mark");for(let a of e)if(t.containsNode(a,!0))return void m.a.info(Object(l.b)("error:e7"));if(!Qt(n,a))return void m.a.info("Failed to highlight text. Try a shorter selection.");Ft[n.id]=n,Kt((o=n).pid)||Dt()?he.cancel({aid:o.id}):(Nt(),$(`#${o.pid}`).addClass("annotation-edit"),$(".annotation-edit").wrapAll(Ct),$(".annotate-wrapper").prepend(kt()),Bt(o.pid,o.id),$(`[data-annotation-id="${o.id}"]`).addClass("show"))}var o}(e))})),At(t)}var Vt=a(15);let Yt,Zt={};let Xt=new Map;function te(t,e){$(`#p${t.pid} > span.pnum`).addClass("has-bookmark"),Jt(t.annotation.selectedText,function(t){let e=Xt.get(t);return void 0===e?(Xt.set(t,0),0):(e+=1,Xt.set(t,e),e)}(t.pid),e),se(t.annotation),le(t.annotation,"highlight")}function ee(t,e){"selectedText"===(t.annotation.selectedText?"selectedText":"note")?te(t):function(t){ce(t.pid,t.annotation),le(t.annotation,"note")}(t)}function ae(t){!function(t){if(!t)return;let e=Ft[t];e&&(e.wrap&&e.wrap.unwrap(),delete Ft[t])}(t.annotation.aid)}function ne(t){!function(t){$(`#${t.annotation.rangeStart} > span.pnum`).removeClass("has-annotation");let e=parseInt(t.annotation.rangeEnd.substr(1),10),a=parseInt(t.annotation.rangeStart.substr(1),10),n=a;do{$(`#p${a}`).removeClass("note-style-bookmark"),a===n&&$(`#p${a}`).removeClass("note-style-bookmark-start"),a===e&&$(`#p${a}`).removeClass("note-style-bookmark-end"),a++}while(a<=e)}(t)}function oe(t,e){"selectedText"===(t.annotation.selectedText?"selectedText":"note")?function(t,e){$(`#p${t.pid} > span.pnum`).addClass("has-bookmark"),Jt(t.annotation.selectedText,e),se(t.annotation),le(t.annotation,"highlight"),$(`[data-annotation-id="${t.annotation.aid}"]`).attr("data-aid",t.creationDate)}(t,e):function(t){ce(t.pid,t.annotation),le(t.annotation,"note"),$(`#${t.annotation.rangeStart} > span.pnum`).attr("data-aid",t.creationDate)}(t)}function ie(t,e,a){switch(t){case"loaded":ee(e);break;case"created":oe(e,a);break;case"updated":!function(t){let e;if(!t.aid)return;if(!t.topicList||0===t.topicList.length){if("new"===t.status)return;let e=$(`[data-annotation-id="${t.aid}"]`).attr("class").split(" ");return void $(`[data-annotation-id="${t.aid}"]`).attr("class",`${e[0]} ${e[1]}`)}e=t.topicList.reduce((t,e)=>`${t} ${e.value}`,""),e=e.trim();let a=e.split(" "),n=$(`[data-annotation-id="${t.aid}"]`).attr("class").split(" ");1===n.length||a.unshift(n[1]),a.unshift(n[0]),e=a.reduce((t,e)=>`${t} ${e}`,""),$(`[data-annotation-id="${t.aid}"]`).attr("class",e)}(e.annotation),function(t){if(t.annotation.selectedText)return;let e=parseInt(t.annotation.rangeStart.substr(1),10),a=parseInt(t.annotation.rangeEnd.substr(1),10),n=e,o=!1;do{$(`#p${e}`).removeClass("note-style-bookmark"),$(`#p${e}`).removeClass("note-style-bookmark-start"),$(`#p${e}`).hasClass("note-style-bookmark-end")&&($(`#p${e}`).removeClass("note-style-bookmark-end"),o=!0),e++}while(!o);e=n;do{$(`#p${e}`).addClass("note-style-bookmark"),e===n&&$(`#p${e}`).addClass("note-style-bookmark-start"),e===a&&$(`#p${e}`).addClass("note-style-bookmark-end"),e++}while(e<=a)}(e);break;case"deleted":!function(t,e){"selectedText"===(t.annotation.selectedText?"selectedText":"note")?ae(t):ne(t),t.annotation.links&&$(`i[data-link-aid="${t.creationDate}"]`).remove(),0===e&&$(`#${t.annotation.rangeStart} > span.pnum`).removeClass("has-bookmark")}(e,a)}}function re(t){return`\n    ${t.map(t=>`\n      ${function(t){let e=JSON.parse(t.link),a=ue(e),n=`${e.desc.source}:${e.desc.book}:${e.desc.unit}`;return n=e.desc.question?`${n}:${e.desc.question}:${e.desc.pid}`:`${n}:${e.desc.pid}`,`<a class="item" href="${a}">${t.reference}[${n}]</a>`}(t)}\n    `).join("")}\n  `}function se(t){if(t.topicList&&t.topicList.length>0){let e=t.topicList.reduce((t,e)=>`${t} ${e.value}`,"");$(`[data-annotation-id="${t.aid}"]`).addClass(e)}}function ce(t,e){$(`#p${t} > span.pnum`).addClass("has-annotation").attr("data-aid",e.creationDate);let a=parseInt(e.rangeEnd.substr(1),10),n=t;do{$(`#p${n}`).addClass("note-style-bookmark"),n===t&&$(`#p${n}`).addClass("note-style-bookmark-start"),n===a&&$(`#p${n}`).addClass("note-style-bookmark-end"),n++}while(n<=a)}function le(t,e){t.links&&$(`[data-aid="${t.creationDate}"]`).eq(-1).after(`<i data-link-aid="${t.creationDate}" data-type="${e}" class="small bm-link-list linkify icon"></i>`)}function pe(t){let e=g()(t);var a;if(e.rangeStart=e.rangeStart.trim(),e.rangeEnd=e.rangeEnd.trim(),e.rangeEnd.startsWith("p")||(e.rangeEnd=`p${e.rangeEnd}`),""===e.Comment?delete e.Comment:e.Comment=Object(u.a)(e.Comment),""===e.Note?delete e.Note:e.Note=Object(u.a)(e.Note),""===e.creationDate&&delete e.creationDate,""===e.aid?delete e.aid:(e.selectedText=(a=e.aid,Ft[a]),e.rangeEnd=e.rangeStart,e.creationDate&&(e.selectedText.aid=e.creationDate.toString(10)),delete e.textId),0===e.topicList.length&&delete e.topicList,delete e.newTopics,delete e.hasAnnotation,"update"===e.status){Yt.getItem(e.rangeStart,e.aid).annotation.topicList.forEach(t=>{if(t.summary){let a=e.topicList.find(e=>e.value===t.value);a&&(a.summary=t.summary)}})}v.postAnnotation(e)}function de(t,e){!async function(t){let e=Zt.keyInfo.genPageKey(),a=Object(i.b)();if(a)try{let o=await Object(n.c)(a.userId,e);Yt=new h(o,t),o.length>0&&d()}catch(t){console.error(t)}}(t),Gt(e),$(".toggle-bookmark-highlight").on("click",(function(t){t.preventDefault();let e=$(".transcript");e.hasClass("hide-bookmark-highlights")?(e.removeClass("hide-bookmark-highlights"),$(".toggle-bookmark-highlight").text("Hide Highlighted Text")):(e.addClass("hide-bookmark-highlights"),$(".toggle-bookmark-highlight").text("Show Highlighted Text"))})),$("#bookmark-toggle-disable-selection").on("click",(function(t,e){t.preventDefault();let a=!0;"undefined"!==e&&(a="false"!==e);let n=$(".transcript");n.hasClass("disable-selection")&&n.hasClass("user")?Object(l.b)("menu:m1",!0,"Disable Bookmark Creation").then(t=>{n.removeClass("disable-selection user"),$(".toggle-bookmark-selection").text(t),$("#bookmark-dropdown-menu > span  i.bookmark-corner-icon").addClass("hide"),a&&m.a.success("Bookmark Creation Enabled"),Object(r.c)("bmCreation","enabled")}):Object(l.b)("menu:m2",!0,"Enable Bookmark Creation").then(t=>{n.addClass("disable-selection user"),$(".toggle-bookmark-selection").text(t),$("#bookmark-dropdown-menu > span  i.bookmark-corner-icon").removeClass("hide"),a&&m.a.success("Bookmark Creation Disabled"),Object(r.c)("bmCreation","disabled")})})),function(){let t=Object(r.a)("bmCreation");t&&"enabled"===t||$("#bookmark-toggle-disable-selection").trigger("click","false")}(),function(t){$(".transcript").on("click","td.follow-link-item",(function(e){e.preventDefault();let a=$(this).parent("tr").attr("data-index"),n=t(a),o=JSON.parse(n.link);location.href=ue(o)}))}(xt),$(".transcript").on("click",".bm-link-list.linkify",(function(t){t.preventDefault();let e,a=$(this).attr("data-type"),n=$(this).parent("p").attr("id");"note"===a?e=$(this).prev("span").attr("data-aid"):"highlight"===a&&(e=$(this).prev("mark").attr("data-annotation-id"));let o=Yt.getItem(n,e);if(!o)return;let i=re(o.annotation.links);$(".bm-link-list-popup").html(i),$(this).popup({popup:".bm-link-info.popup",hoverable:!0,on:"click"}).popup("show")}))}const he={submit(t){let e=function({newTopics:t}){let e=t.replace(/[^a-zA-Z0-9, ]/g,"");if(!e||""===e)return[];e=e.replace(/^,*/,""),e=e.replace(/,*$/,"");let a=e.split(",");return a=a.map(t=>t.trim()),a=a.map(t=>w()(t)),a=a.map(t=>/ /.test(t)?{value:t.replace(/ /g,""),topic:t}:{value:t,topic:t}),a}(t);e.length>0?function(t,e){v.fetchTopics().then(a=>{let n=y()(t,a.topics,(t,e)=>e.value===t.value);if(n.length>0){let t=a.topics.concat(n);t.sort((t,e)=>{let a,n;return a=t.topic.toLowerCase(),n=e.topic.toLowerCase(),a<n?-1:a>n?1:0}),a.topics=t,Object(r.c)("bmTopics",a);let s=Object(i.b)(),c=`${Zt.sourceId}`;Object(o.b)(s.userId,c,t),e.topicList=e.topicList.concat(n),e.newTopics=n,pe(e)}}).catch(t=>{throw new Error(`bookmark.js:addToTopicList() error: ${t}`)})}(e,t):pe(t)},cancel(t){!t.creationDate&&t.aid&&function(t){if(!t)return;let e=Ft[t];e.aid||(e.wrap&&e.wrap.unwrap(),delete Ft[t])}(t.aid)},async delete(t){try{await v.deleteAnnotation(t.rangeStart,t.creationDate)}catch(t){throw new Error(t)}}};function ue(t){let e=Object(Vt.c)(t.key);return location.pathname===e?`#${t.desc.pid}`:`${e}?v=${t.desc.pid}`}var fe=function(t,e){Zt=e,function(t){k=t}(Zt),$(".transcript").length&&function(t,e){let a=Object(C.g)();if(a&&it(a,e),!Object(i.b)())return;a||de(t,e);let n=Object(C.d)();n&&ot(n,e)}(t,e),bt(e)};let me,be={};function ge(){$(".share-annotation-close").on("click",(function(t){t.preventDefault(),me.selectedText&&me.selectedText.wrap.unwrap(),$("#shared-annotation-wrapper > .header").remove(),$(".shared-selected-annotation").unwrap(),$(".selected-annotation").removeClass("shared-selected-annotation"),$(".bookmark-selected-text.shared").removeClass("shared"),Ht()}))}function $e(){return new Promise(async(t,e)=>{let a=Object(C.c)();if(!a)return void t(!1);let[o,i,r]=decodeURIComponent(a).split(":");if(!o)return void t(!1);if(0===$(`#${o}`).length)return void t(!1);let s=be.keyInfo.genParagraphKey(o);Object(C.b)();try{const e=await Object(n.b)(r,s,i);if(!e.userId)return Ht(),Object(C.a)(),m.a.warning("Requested Bookmark was not found"),void t(!1);let a=document.getElementById(e.rangeStart);e.selectedText&&Qt(e.selectedText,a),$(`[data-aid="${i}"]`).addClass("shared"),function(t){let e=[t.rangeStart,t.rangeEnd].map(t=>parseInt(t.substr(1),10)),a=K()(e[0],e[1]+1),n=`\n    <h4 class="ui header">\n      <i title="${Object(l.b)("action:close")}" class="share-annotation-close small window close icon"></i>\n      <div class="content">\n        ${t.Comment?t.Comment:""}\n      </div>\n    </h4>\n  `;for(let t=0;t<a.length;t++)$(`#p${a[t]}`).addClass("shared-selected-annotation");$(".shared-selected-annotation").wrapAll("<div id='shared-annotation-wrapper' class='ui raised segment'></div>"),$("#shared-annotation-wrapper").prepend(n),E()(document.getElementById("shared-annotation-wrapper"),{align:{top:.2}})}(e),me=e,ge(),Object(C.a)()}catch(e){return Object(C.a)(),console.error(e),void t(!1)}t(o)})}var ke=function(t){return be=t,$e()},ve=a(7),xe=a(14);function ye(t){if("transcript"===t){ke(ve.a).then(t=>{fe(t,ve.a)});let t=ve.a.keyInfo.genPageKey();Object(xe.b)(t).then(t=>{let e=`${t.source}<br/>${t.bookTitle}`;t.subTitle&&(e=`${e}<br/>${t.subTitle}`),e=`${e}<br/>${t.title}`,$("#transcript-page-info").html(e)})}else fe(void 0,ve.a);A(ve.a)}},3:function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return c})),a.d(e,"b",(function(){return l}));var n=a(16),o=a.n(n);let i=new Map;function r(t){const e=i.get(t);if(!e)throw new Error(`store: key not found: ${t}`);return e}function s(t,e){o.a.set(r(t),e)}function c(t,e){return o.a.get(r(t))||e}function l(t){let e=t.sid;for(const a in t.store)i.set(a,`${e}.${t.store[a]}`)}},30:function(t,e,a){"use strict";var n=a(5),o=a.n(n),i=a(14),r=a(115),s=a.n(r),c=a(3);const l=a(27);function p(t,e,a,n){return`\n    <h3>${e[t]} (${n.length})</h3>\n    <div class="ui list">\n      ${n.map(t=>`\n        <div class="item">\n          <i class="book icon"></i>\n          <div class="content">\n            <div class="header">\n              ${function(t,e){return t[e.pageKey].title}(a,t)} (${t.m.length})\n            </div>\n            <div class="list">\n              ${t.m.map(e=>`\n                <div class="item">\n                  <i class="search icon"></i>\n                  <div class="content">\n                    <div class="header">\n                      <a href="${a[t.pageKey].url}?srch=${e.location}">Paragraph ${e.location.substr(1)}</a>\n                    </div>\n                    <div class="description">\n                      ${e.context}\n                    </div>\n                  </div>\n                  </div> \x3c!-- item --\x3e\n              `).join("")}\n            </div> \x3c!-- list --\x3e\n          </div>\n        </div>\n      `).join("")}\n    </div> \x3c!-- ui list --\x3e\n  `}function d(t){let e=l.getKeyInfo().keyLength,a=[],n=0;for(const o of t)a[n]?a[n].unit!==o.unit?(n++,a[n]={unit:o.unit,book:o.book,pageKey:o.key.substr(0,e),m:[{location:o.location,context:o.context}]}):a[n].m.push({location:o.location,context:o.context}):a[n]={unit:o.unit,book:o.book,pageKey:o.key.substr(0,e),m:[{location:o.location,context:o.context}]};return a}function h(t){let e=l.getKeyInfo().keyLength,a=t.map(t=>t.key.substr(0,e));return s()(a)}function u(t,e){const a=l.getBooks();let n=[];for(let e=0;e<a.length;e++){let o=a[e];if(t[o]){let e=h(t[o]);for(const t of e)n.push(Object(i.b)(t))}}Promise.all(n).then(n=>{let o="",i={},r={};for(const t of n){let{bookTitle:e,title:a,subTitle:n,url:o}=t;n&&(a=`${a}: ${n}`),i[t.pageKey]={title:a,url:o},r[t.bookId]||(r[t.bookId]=e)}let s={};for(let e of a)t[e]&&(s[e]=d(t[e]),o+=p(e,r,i,s[e]));$(".cmi-search-list").html(o),$("#search-results-header").html(`: <em>${e}</em>`),function(t,e,a,n,o,i){const r=l.getBooks();let s=l.getKeyInfo().keyLength;if(0===e)return;let p=[];for(const t of r)if(i[t])for(const e of i[t]){let t={key:e.key.substr(0,s),url:`/${e.book}/${e.unit}/`,location:e.location};p.push(t)}Object(c.c)("srchResults",{query:t,count:e,titleArray:a,pageInfo:n,data:o,flat:p})}(e,t.count,r,i,s,t)}).catch(t=>{console.error("Error: %s",t.message)})}var f=a(8),m=a(9),b=a.n(m),g=a(1),k=a.n(g);const v=a(27);function x(t,e){b()(document.getElementById(t),{align:{top:.2}},t=>{})}class y{constructor(t,e,a,n){this.query=t,this.start=e,this.end=a,this.count=a-e+1,this.hits=n}setStart(t,e){this.current=t;let a=this.hits[t].location;e?setTimeout(x,250,a,"setStart(first)"):x(a),this.setTitle()}setTitle(){let t=this.current-this.start+1,e=`Search for <em>${this.query}</em> (${t} of ${this.count})`;$(".search-navigator-header-query").html(e)}setPrevious(){if(this.start===this.end)return;let t=this.current-1;t<this.start&&(t=this.end),this.setStart(t)}setNext(){if(this.start===this.end)return;let t=this.current+1;t>this.end&&(t=this.start),this.setStart(t)}showCurrent(){let t=this.hits[this.current].location;b()(document.getElementById(t),{align:{top:.2}})}}function I(t){$(".search-navigator .previous-match").on("click",(function(e){e.preventDefault(),t.setPrevious()})),$(".search-navigator .next-match").on("click",(function(e){e.preventDefault(),t.setNext()})),$(".search-navigator .current-match").on("click",(function(e){e.preventDefault(),t.showCurrent()})),$(".search-navigator .close-window").on("click",(function(t){t.preventDefault(),$(".search-navigator-wrapper").addClass("hide-search-navigator"),$(".transcript").removeClass("search-navigator-active"),function(){let t=document.querySelectorAll("mark.show-mark");for(let e of t)e.outerHTML=e.innerHTML}()}))}function w(t){let e=Object(c.a)("srchResults");if(!e)return void k.a.warning("There are no search results to show.");let a=v.genPageKey(),n=a.toString(10),o=v.decodeKey(a).bookId,i=e.titleArray[o];if(!e.pageInfo[a])return void k.a.warning(`There is no search result at ${t}`);let r,s=function(t,e,a){let n={current:-1,prev:-1,start:-1,end:-1,next:-1},o=!1;for(let i=0;i<a.length;i++)if(a[i].key===e)a[i].location===t&&(n.current=i),o?n.end=i:(n.start=i,n.end=i,o=!0,i>0&&(n.prev=i-1));else if(o){n.next=i;break}return n}(t,n,e.flat);if(-1===s.current)return void k.a.warning(`There is no search result at ${t}`);s.prev>-1?(r=`${e.flat[s.prev].url}?srch=${e.flat[s.prev].location}`,$(".search-navigator .previous-page").attr("href",r)):$(".search-navigator .previous-page").addClass("inactive"),s.next>-1?(r=`${e.flat[s.next].url}?srch=${e.flat[s.next].location}`,$(".search-navigator .next-page").attr("href",r)):$(".search-navigator .next-page").addClass("inactive"),s.start===s.end&&($(".search-navigator .previous-match").addClass("inactive"),$(".search-navigator .next-match").addClass("inactive")),$(".search-navigator-header-book").text(`${i} - ${e.pageInfo[a].title}`);let l=new y(e.query,s.start,s.end,e.flat);l.setStart(s.current,!0);let p=function(t,e,a,n,o){let i=0,r=new RegExp("(?:^|\\b)("+n+")(?:$|\\b|)","gim");for(let s=e;s<=a;s++){let e=t[s].location,a=document.getElementById(e);if(!a){i++;continue}let c=a.innerHTML;c=c.replace(/[\r\n]/gm," "),a.innerHTML="show"===o?c.replace(r,"<mark class='show-mark'>$1</mark>"):c.replace(r,"<mark class='hide-mark'>$1</mark>"),a.innerHTML===c&&(console.log('Regex did not match: "%s" for %s',n,e),i++)}return i}(e.flat,s.start,s.end,e.query,"show");p&&k.a.info(`Failed to highlight ${p} search results`),I(l),$(".transcript").addClass("search-navigator-active"),$(".search-navigator-wrapper").removeClass("hide-search-navigator")}const C=Symbol("no_source"),O=Symbol("source_selected"),j=Symbol("searching"),S=Symbol("search_result"),T=Symbol("search_error"),L=Symbol("saved_search");function K(t,e,a,n){switch(t){case C:$(".ui.search.message").addClass("negative"),$(".search-message.header").text("Search Source Not Selected"),$(".search-message-body").html("<p>You forgot to select a search source.</p>");break;case O:$(".ui.search.message").removeClass("negative"),$(uisearchmessageheader).text("search source"),$(uisearchmessagebody).html(`<p>searching from <em>${e}</em></p>`);break;case j:$("#search .ui.icon.input").addClass("loading"),$("#search input").attr("disabled",!0),$(".ui.search.message").addClass("purple"),$(".search-message.header").text("Search Started..."),$(".search-message-body").html(`<p>Searching for <em>${a}</em></p>`);break;case L:$(".search-message.header").text("Last Search Result"),$(".search-message-body").html(`<p>Search for <em>${a}</em> from <em>${e}</em> found ${n} matches</p>`);break;case S:$("#search .ui.icon.input").removeClass("loading"),$("#search input").attr("disabled",!1),$(".ui.search.message").removeClass("purple").removeClass("negative"),n>0&&$("#search input").val(""),$(".search-message.header").text("Search Result"),$(".search-message-body").html(`<p>Search for <em>${a}</em> found ${n} matches</p>`);break;case T:$("#search .ui.icon.input").removeClass("loading"),$("#search input").attr("disabled",!1),$(".ui.search.message").removeClass("purple").addClass("negative"),$(".search-message.header").text("Search Error"),$(".search-message-body").html(`<p>${e}</p>`)}}function D(){let t=Object(f.f)();t&&w(t)}function E(){$(".search.ui.modal").modal({dimmerSettings:{opacity:.5},observeChanges:!0,onShow:function(){0===$(".cmi-search-list > h3").length&&function(){const t=Object(c.a)("srchResults");if(!t)return;const e=l.getBooks();let a="";for(let n of e)t.data[n]&&(a+=p(n,t.titleArray,t.pageInfo,t.data[n]));$(".cmi-search-list").html(a),$(".search-message.header").text("Last Search Result"),$(".search-message-body").html(`<p>Search for <em>${t.query}</em> found ${t.count} matches</p>`),$("#search-results-header").html(`: <em>${t.query}</em>`)}()}}),$(".search-modal-open").on("click",t=>{t.preventDefault(),$(".search.ui.modal").modal("show")}),$("#search").submit((function(t){t.preventDefault();var e=$("#search .source").text(),a=$("#search input").val();0!==a.length&&(K(j,e,a),function(t){let e={query:t,width:30};o.a.post("https://d9lsdwxpfg.execute-api.us-east-1.amazonaws.com/latest/wom",e).then(a=>{K(S,"",t,a.data.count),a.data.count>0?u(a.data,e.query):k.a.info(`Search for ${t} didn't find any matches`),document.getElementById("search-input-field").focus()}).catch(t=>{console.error("search error: %o",t),K(T,t.message)})}(a))}))}e.a={initialize:function(){$(".transcript").length&&D(),E()}}},31:function(t,e,a){"use strict";var n=a(116),o=a.n(n);function i(t,e){let a=t.filter(t=>{if("!"===t.element[0])return t.element=t.element.substring(1),!0;let e=t.element.substring(1),a=document.getElementById(e);return!!a&&null!==a.offsetParent});if(0===a.length)return;e||(e={allowClose:!1,opacity:.5});const n=new o.a(e);n.defineSteps(a),n.start()}const r={element:"#masthead-title",popover:{title:"Navigation and Features",description:"On every page you can click on this banner to navigate to the Library's main page and see all available teachings.",position:"bottom"}},s={element:"#page-menu",popover:{title:"The Menu",description:"This is the page menu, it will stick to the top when the page is scrolled (when the tour is over) so it is always available. The menu on other pages is similar but may contain additional features.<br/><br/>A brief description of each menu option follows.",position:"bottom"}},c={element:"#bookmark-dropdown-menu",popover:{title:"List Bookmarks",description:"Display a list of bookmarks you have created and optionally filter by topic. You can quickly jump to any bookmark. Learn more about bookmarks in the documentation.",position:"bottom"}},l={element:"#search-modal-open",popover:{title:"Search Through All Books",description:"Find topics of interest by searching through all ACIM books.",position:"bottom"}},p={element:"#help-menu",popover:{title:"Get Help and Learn About",description:"Learn about the Library and using the features of the site.",position:"bottom"}},d={element:"#login-guest-menu-option",popover:{title:"Sign In/Sign Out",description:"Create an account and sign in to the site. It's free and allows you to create bookmarks that you can share via Facebook and keep synchronized between devices.",position:"left"}},h={element:"#login-account-menu-option",popover:{title:"Sign In/Sign Out",description:"Create an account and sign in to the site. It's free and allows you to create bookmarks that you can share via Facebook and keep synchronized between devices.",position:"left"}},u={element:"[data-book='acq']",popover:{title:"Display Table of Contents",description:"Click on any image to display the table of contents or navigate directly to the teaching.",position:"left"}},f={element:"#masthead-title",popover:{title:"Library of Christ Mind Teachings",description:"This banner identifies the page as being part of the Teachings of Christ Mind Library. Click this link to navigate to the Library's Home page.",position:"bottom"}},m={element:"#src-title",popover:{title:"The Library",description:"This identifies the source or section of the library the page is a part of. Click this link to navigate to the section Home page.",position:"bottom"}},b={element:"#book-title",popover:{title:"Page Title",description:"This identifies the book and section or lesson of the content on this page.",position:"bottom"}},g={element:"#bookmark-dropdown-menu",popover:{title:"Bookmarks",description:"You can create a bookmark from highlighted text and associate the bookmark with one or more categories. Learn more about bookmarks by reading the documentation.",position:"right"}},k={element:"#search-modal-open",popover:{title:"Search Through All Books",description:"Find topics of interest by searching through all ACIM books.",position:"bottom"}},v={element:"#audio-player-menu-option",popover:{title:"Listen to the Audio",description:"Click the speaker icon to display the audio player and listen along as you read.",position:"bottom"}},x={element:"#pnum-toggle-menu-option",popover:{title:"Show/Hide Paragraph Markers",description:"Show or hide the markers that preceed each paragraph.",position:"bottom"}},y={element:"#jump-to-top-menu-option",popover:{title:"Go To Top of Page",description:"Quickly jump to the top of the page.",position:"bottom"}},I={element:"#contents-modal-open",popover:{title:"Table of Contents",description:"View the table of contents.",position:"bottom"}},w={element:"#toc-previous-page",popover:{title:"Previous Page",description:"Go to the previous page. This will be disabled when the first page is displayed.",position:"bottom"}},C={element:"#toc-next-page",popover:{title:"Next Page",description:"Go to the next page. This will be disabled when the last page is displayed.",position:"bottom"}},O={element:"#quick-links-dropdown-menu",popover:{title:"Quick Links",description:"Quickly navigate to other teachings in the Library.",position:"bottom"}},j={element:"#about-dropdown-menu",popover:{title:"Get Help",description:"Learn how to use features of the Library.",position:"bottom"}},S={element:"#login-guest-menu-option",popover:{title:"Sign In/Sign Out",description:"Create an account and sign in or sign out. When you sign in, bookmarks you create will be available on all devices you use to access the library.",position:"bottom"}},T={element:"#login-account-menu-option",popover:{title:"Sign In/Sign Out",description:"Create an account and sign in or sign out. When you sign in, bookmarks you create will be available on all devices you use to access the library.",position:"bottom"}};function L(){$("#help-menu").on("click","div.item",(function(t){if(t.preventDefault(),$(this).hasClass("page-tour")){$(this).hasClass("development");i([{element:"#source-homepage",popover:{title:"Library of Christ Mind Teachings",description:"Welcome to the Library of Christ Mind Teachings!<br><br>The contents of the library are shown below. Click on a book image to navigate to the home page for that teaching.",position:"bottom"}},{element:"#book-acq",popover:{title:"Get Acquainted",description:"Get Acquainted contains documentation and other useful information about the Library. Click on the image to see the table of contents.",position:"top"}},{element:"#acimoe-christmind-info",popover:{title:"A Course in Miracles Original Edition",description:"The Original Edition of ACIM from the <em>Course in Miracles Society</em>",position:"right"}},{element:"#wom-christmind-info",popover:{title:"The Way of Mastery",description:"The Way of Mastery received by Jon Marc Hammer (Jayem)",position:"right"}},{element:"#acol-christmind-info",popover:{title:"A Course Of Love",description:"A Course Of Love first received by Mari Perron",position:"left"}},{element:"#raj-christmind-info",popover:{title:"The Raj Material",description:"An indepth discussion of A Course in Miracles by Raj through Paul Tuttle",position:"right"}},{element:"#pwom-christmind-info",popover:{title:"Droga Mistrzostwa",description:"A Polish translation of The Way of Mastery",position:"right"}},{element:"#jsb-christmind-info",popover:{title:"The Impersonal Life",description:"A rediscovery of Self received by Joseph Benner, first published in 1914",position:"left"}},{element:"#acim-christmind-info",popover:{title:"A Course in Miracles Sparkly Edition",description:"A slightly different version of ACIM from the Original Edition. This edition is used by Raj.",position:"right"}}])}$(this).hasClass("page-navtour")&&i([r,s,c,p,l,d,h,u]),$(this).hasClass("transcript-tour")&&function(){let t=[];t.push(f),t.push(m),t.push(b),t.push(g),t.push(k),t.push(v),t.push(x),t.push(y),t.push(I),t.push(w),t.push(C),t.push(O),t.push(j),t.push(S),t.push(T),i(t)}(),$(this).hasClass("about-src")&&(location.href="/about/"),$(this).hasClass("read-documentation")&&(location.href="/acq/quick/"),$(this).hasClass("view-documentation")&&(location.href="/acq/video/"),$(this).hasClass("contact-me")&&(location.href="/acq/contact/")})),$(".login-menu-option-account").on("click","div.item",(function(t){$(this).hasClass("profile-management")&&(location.href="/profile/email/"),$(this).hasClass("topic-management")&&(location.href="/profile/topicMgt/")})),$("#quick-links").on("click","div.item",(function(t){t.preventDefault();let e=$(this).attr("data-href");location.href=e}))}e.a={initialize(){L()}}},4:function(t,e,a){"use strict";a.d(e,"b",(function(){return d}));var n=a(17),o=a.n(n),i=a(110),r=a.n(i),s=a(16),c=a.n(s),l=(a(8),a(2));let p;function d(t){return p?{email:p.email,userId:r()(p.email),name:p.user_metadata.full_name,roles:p.app_metadata.roles,avatar_url:p.user_metadata.avatar_url}:null}function h(t){let e=c.a.get("cmi.login.state")||"init";switch(t){case"init":case"dialog":c.a.set("cmi.login.state",t);break;case"login":"dialog"===e&&p.app_metadata.roles&&p.app_metadata.roles.find(t=>"acol"===t)&&location.pathname.startsWith("/t/acol/")&&"/t/acol/"!==location.pathname&&(location.href="/t/acol/"),c.a.set("cmi.login.state",t)}}e.a={initialize:function(){o.a.on("init",t=>{h("init")}),o.a.on("login",t=>{p=t,function(){let t=d();Object(l.b)("action:signout",!0,"Sign Out").then(e=>{$(".login-menu-option-guest").addClass("hide"),$(".login-menu-option-account").removeClass("hide"),$(".account-signout-option").text(`${e}: ${t.name}`)}),$(".main.menu a > span > i.bookmark.icon").addClass("green").removeClass("red"),$(".main.menu .ui.text.container").addClass("signed-in"),$(".hide.profile-management.item").removeClass("hide"),$(".requires-signin").removeClass("hide")}(),h("login")}),o.a.on("logout",()=>{Object(l.b)("action:signin",!0).then(t=>{$(".login-menu-option-guest").removeClass("hide"),$(".login-menu-option-account").addClass("hide")}),$(".main.menu a > span > i.bookmark.icon").addClass("red").removeClass("green"),$(".main.menu .ui.text.container").removeClass("signed-in"),$(".profile-management.item").addClass("hide"),$(".requires-signin").addClass("hide"),p=null,location.href="/"}),o.a.on("error",t=>{console.error("user.on('error'): ",t)}),$(".login-menu-option-account > .menu > .account-signout-option").on("click",t=>{t.preventDefault(),o.a.logout()}),$(".login-menu-option-guest").on("click",t=>{t.preventDefault(),h("dialog"),o.a.open()}),o.a.init({})}}},6:function(t,e,a){"use strict";e.a={acolManager:"rmercer33+acol@gmail.com",cmiUserId:"05399539cca9ac38db6db36f5c770ff1",sources:"/public/config/sources.json",user:"https://kkdlxunoe7.execute-api.us-east-1.amazonaws.com/latest",acol:"https://kkdlxunoe7.execute-api.us-east-1.amazonaws.com/latest/acol/access",search:"https://x5rigstpd2.execute-api.us-east-1.amazonaws.com/latest/search"}},7:function(t,e,a){"use strict";var n=a(14);const o=a(27);e.a={sid:"www",env:"integration",lang:"en",url_prefix:"",sourceId:99,getPageInfo:n.b,keyInfo:o,store:{bmList:"bm.list",bmCreation:"bm.creation",bmTopics:"bm.topics",bmModal:"bm.modal",srchResults:"srch.results",pnDisplay:"pn.display",cfgacq:"cfg.acq",cfgprofile:"cfg.profile"}}},8:function(t,e,a){"use strict";a.d(e,"a",(function(){return l})),a.d(e,"b",(function(){return p})),a.d(e,"e",(function(){return d})),a.d(e,"g",(function(){return h})),a.d(e,"d",(function(){return u})),a.d(e,"f",(function(){return f})),a.d(e,"c",(function(){return m}));var n=a(9),o=a.n(n);let i="";function r(t){let e=window.location.search.substring(1);0===e.length?e=i:i=e;let a=e.split("&");for(let e=0;e<a.length;e++){let n=a[e].split("=");if(n[0]===t)return n[1]}return null}function s(t,e){o()(document.getElementById(t),{align:{top:.2}},t=>{})}function c(){history.replaceState({},document.title,location.origin+location.pathname)}function l(){$("#transcript-page-loading").removeClass("active"),c()}function p(){r("as")&&$("#transcript-page-loading").addClass("active")}function d(){let t=r("v");t&&(setTimeout(s,250,t,"showParagraph"),c())}function h(){let t=r("tnav"),e=r("topic");return t?(c(),{pid:t,topic:e}):null}function u(){let t=r("bkmk");return t?(c(),t):null}function f(){let t=r("srch");return t?(c(),t):null}function m(){let t=r("as");return t||null}}}]);