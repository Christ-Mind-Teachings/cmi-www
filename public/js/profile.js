!function(e){function t(t){for(var o,r,s=t[0],l=t[1],d=t[2],u=0,p=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(c&&c(t);p.length;)p.shift()();return i.push.apply(i,d||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],o=!0,s=1;s<a.length;s++){var l=a[s];0!==n[l]&&(o=!1)}o&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var o={},n={3:0},i=[];function r(t){if(o[t])return o[t].exports;var a=o[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=o,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(a,o,function(t){return e[t]}.bind(null,o));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/public/js";var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;i.push([285,1,0]),a()}({285:function(e,t,a){e.exports=a(287)},287:function(e,t,a){"use strict";a.r(t);var o=a(3),n=a(21),i=a(29),r=a(30),s=a(24),l=a(4),d=a(31),c=a(1),u=a.n(c),p=a(25),m=a(14);let h=[];function f(){$("button.save-to-database").removeClass("disabled")}function v(){$("#email-list-table").on("click",".delete-maillist-item",(function(e){e.stopPropagation(),e.preventDefault();let t=$(this).parent(),a=parseInt(t.attr("data-index"),10);h[a].deleted=!0,t.remove(),f()})),$("#email-list-table").on("click","td.edit-maillist-item",(function(e){e.stopPropagation(),e.preventDefault();let t=parseInt($(this).parent().attr("data-index"),10);$("#addto-maillist-form").form("set values",h[t]),$("#add-or-update").text("Update").attr("data-index",t),$(".addto-maillist-dialog-wrapper.hide").removeClass("hide")})),$("button.add-name-to-maillist").on("click",(function(e){e.preventDefault(),e.stopPropagation(),$("#add-or-update").text("Add"),$(".addto-maillist-dialog-wrapper.hide").removeClass("hide")})),$("button.save-to-database").on("click",(function(e){e.preventDefault(),e.stopPropagation(),$(".addto-maillist-dialog-wrapper").addClass("hide"),async function(){let e=Object(l.b)(),t=h.filter(e=>!e.deleted),a={userId:e.userId,mailList:t};try{$(".sync.icon").addClass("loading");let t=await Object(p.b)(e.userId,a);u.a.info(`Saved! ${t}`),$(".sync.icon.loading").removeClass("loading"),$("button.save-to-database").addClass("disabled")}catch(e){$(".sync.icon.loading").removeClass("loading"),u.a.error(e)}}()})),$("form[name='addtomaillist']").on("submit",(function(e){e.preventDefault(),e.stopPropagation();let t=$("#add-or-update").text(),a=$("#addto-maillist-form").form("get values");if(a.first=Object(m.a)(a.first),a.last=Object(m.a)(a.last),a.address=Object(m.a)(a.address),"Add"===t){h.push({first:a.first,last:a.last,address:a.address});let e=(o=a,`\n    <tr data-index="${h.length-1}">\n      <td class="delete-maillist-item"><i class="trash alternate icon"></i></td>\n      <td class="edit-maillist-item"><i class="pencil alternate icon"></i></td>\n      <td data-name="first">${o.first}</td>\n      <td data-name="last">${o.last}</td>\n      <td data-name="address">${o.address}</td>\n    </tr>\n  `);$("#email-list-table").append(e),f()}else{let e=parseInt($("#add-or-update").attr("data-index"),10);h[e]={first:a.first,last:a.last,address:a.address},$(`tr[data-index="${e}"] > td[data-name="first"]`).text(h[e].first),$(`tr[data-index="${e}"] > td[data-name="last"]`).text(h[e].last),$(`tr[data-index="${e}"] > td[data-name="address"]`).text(h[e].address),$(".addto-maillist-dialog-wrapper").addClass("hide"),f()}var o;$("#addto-maillist-form").form("clear")})),$(".addto-maillist-cancel").on("click",(function(e){e.preventDefault(),e.stopPropagation(),$(".addto-maillist-dialog-wrapper").addClass("hide")}))}var b=a(15),g=a(22),y=a(11),k=a(5),C=a.n(k),w=a(6);var x=a(47),I=a.n(x),q={title:{10:"The Way of Mastery",11:"The Impersonal Life",12:"ACIM Sparkley Edition",13:"The Raj Material",14:"A Course Of Love",15:"ACIM Original Edition",16:"Droga Mistrzostwa"},12:[{value:"*",name:"All Books"},{value:"122",name:"Text"},{value:"123",name:"Workbook for Students"},{value:"124",name:"Manual for Teachers"},{value:"121",name:"Preface"}],15:[{value:"*",name:"All Books"},{value:"151",name:"Text"},{value:"152",name:"Workbook for Students"},{value:"153",name:"Manual for Teachers"}],14:[{value:"*",name:"All Books"},{value:"1404",name:"The Course"},{value:"1402",name:"The Treatises"},{value:"1403",name:"The Dialogues"}],11:[{value:"*",name:"All Books"}],13:[{value:"*",name:"All Books"},{value:"1301",name:"You Are the Answer"},{value:"1302",name:"Graduation"},{value:"1303",name:"ACIM Study Group 2002"},{value:"1304",name:"ACIM Study Group 2003"},{value:"1305",name:"ACIM Study Group 2004"},{value:"1306",name:"ACIM Study Group 2005"},{value:"1307",name:"ACIM Study Group 2006"},{value:"1308",name:"ACIM Study Group 2007"},{value:"1309",name:"ACIM Study Group 2008"},{value:"1310",name:"ACIM Study Group 2009"},{value:"1311",name:"ACIM Study Group 2010"},{value:"1312",name:"ACIM Study Group 2011"},{value:"1313",name:"ACIM Study Group 2012"},{value:"1314",name:"ACIM Study Group 2013"},{value:"1315",name:"ACIM Study Group 2014"},{value:"1316",name:"ACIM Study Group 2015"},{value:"1317",name:"ACIM Study Group 2016"},{value:"1318",name:"ACIM Study Group 2017"},{value:"1319",name:"ACIM Study Group 2018"}],10:[{value:"*",name:"All Books"},{value:"101",name:"The Jeshua Letters"},{value:"102",name:"The Way of the Servant"},{value:"103",name:"The Early Years"},{value:"104",name:"The Way of the Heart"},{value:"105",name:"The Way of Transformation"},{value:"106",name:"The Way of Knowing"}],16:[{value:"*",name:"Wszystkie książki"},{value:"1601",name:"Listy Jeszuy"},{value:"1602",name:"Droga Sługi"},{value:"1606",name:"Wczesne lata Drogi"},{value:"1603",name:"Droga Serca"},{value:"1604",name:"Droga Przemiany"},{value:"1605",name:"Droga Poznania"}]};let A={},T={},D={};function j(e){let t=T[e];if($("#topicSelectNew").dropdown("clear"),!t)return void $("#topic-list-new").html("");let a=function(e){return`\n    <div class="item" data-value="*">** Show All Bookmarks</div>\n    ${e.map(e=>`${e.deleted?"":function(e){return`\n    <div class="item" data-value="${e.value}">${e.topic}</div>\n  `}(e)}`).join("")}\n  `}(t);$("#topic-list-new").html(a),$("#manageTopicsButton").removeAttr("disabled").attr("data-sid",e),$("#displayBookmarksButtonNew").removeAttr("disabled").attr("data-sid",e)}function O(e,t){let a=Object(b.b)(e);Promise.all(a).then(e=>{let a=function(e,t){return`\n    <p>\n      ${t.source}<br/>\n      ${e.length} Bookmarks include topics: <em>${t.topicArray.join(` ${t.condition} `)}</em> <br/>\n      ${(new Date).toLocaleString()}\n    </p>\n    ${e.map(e=>{return`${t=e,`\n    <div class="ui vertical segment bookmark-segment ${t.mgr.type}">\n      <div class="ui small header bookmark-header">\n        <a id="${t.annotation.creationDate}" target="_blank" href="${t.mgr.url}?v=${t.mgr.pid}&key=${t.paraKey}">${t.mgr.title?t.mgr.title:t.mgr.url}</a>\n        <br/>\n        <div class="ui horizontal bulleted link list">\n          ${function(e,t=!1){return e&&0!==e.length?`\n    ${e.map(e=>`\n      <div class="item">\n        <em>${t?e:e.topic}</em>\n      </div>\n    `).join("")}\n  `:'\n      <div class="item">\n        <em>Annotation has no topics</em>\n      </div>\n    '}(t.annotation.topicList)}\n        </div>\n        ${t.mgr.comment?"<br/>":""}\n        ${t.mgr.comment?t.mgr.comment:""}\n      </div>\n      ${a=t.mgr.content,`\n    ${a.map(e=>`\n      <p>\n        ${e.text}\n      </p>\n    `).join("")}\n  `}\n      <p ${"note"!==t.mgr.type?`class='cmi-manage-quote ${t.annotation.quote?"in-database":""} ${t.annotation.creationDate}'`:""}>\n        ~${t.paraKey}${"note"===t.mgr.type?"":`:${t.annotation.creationDate}:${t.annotation.rangeStart}`}\n      </p>\n    </div>\n  `}`;var t,a}).join("")}\n  `}(e,t);$("#activity-report-controls").remove(),$("#activity-report").html(a)})}function S(e){"open"===e?(M(),$("#action-manager > .annotation-actions").addClass("hide"),$("#manageTopicsButton").text("Un-Manage Topics"),$("#topicTable").removeClass("hide")):"close"===e&&($("#manageTopicsButton").text("Manage Topics"),$("#topicTable").addClass("hide"))}function M(){$("#activity-report").html(""),$("#topicSelectNew").dropdown("clear"),$(".condition-checkbox.default").trigger("click"),$(".style-checkbox.default").trigger("click")}function P(){$(".style-checkbox.default").trigger("click"),$("#action-manager > .annotation-actions .hide-headers").hasClass("hide")&&($("#action-manager > .annotation-actions .hide-headers").removeClass("hide").html("Hide Headers"),$("#activity-report .bookmark-header").removeClass("hide")),$("#action-manager > .annotation-actions .hide-quotes").hasClass("hide")&&($("#action-manager > .annotation-actions .hide-quotes").removeClass("hide").html("Hide Quotes"),$("#activity-report .bookmark-segment.hide").removeClass("hide"),$("#activity-report .bookmark-segment.hide").removeClass("qhide"))}function B(){$("#topicSelectNew").dropdown(),$("#action-manager .ui.radio.checkbox").checkbox(),$("#condition-toggle").on("change",(function(e){let t=$("#condition-toggle label").text();$("#condition-toggle label").text("AND"===t?"OR":"AND")})),$("#manageTopicsButton").on("click",(function(e){let t=$(this).attr("data-sid");if($("#topicTable").hasClass("hide")){let e=function(e){return`\n    ${T[e].map((t,a)=>`\n      ${t.deleted?"":function(e,t,a){return`\n    <tr data-sid="${e}" data-index="${a}"> \n      <td class="edit-topic-item"><i class="pencil alternate icon"></i></td>\n      <td class="delete-topic-item"><i class="trash alternate icon"></i></td>\n      <td class="topic">${t.topic}</td>\n    </tr>\n  `}(e,t,a)}`).join("")}\n  `}(t);$("#topicTable > tbody").html(e),S("open")}else S("close")})),$("#topicTable").on("click","td.delete-topic-item",(function(e){let t=parseInt($(this).parent().attr("data-index"),10),a=$(this).parent().attr("data-sid");if($(this).parent().hasClass("deleted"))return void u.a.info("Topic has been deleted");let o=T[a][t];$("#confirmDelete > .header").text(`Delete Topic: "${o.topic}"?`),$("#confirmDelete .actions > .delete-approve").attr("data-sid",a),$("#confirmDelete .actions > .delete-approve").attr("data-index",t),$("#confirmDelete").modal("show")})),$("#topicTable").on("click","td.edit-topic-item",(function(e){let t=parseInt($(this).parent().attr("data-index"),10),a=$(this).parent().attr("data-sid");$(this).parent().hasClass("deleted")?u.a.info("Topic has been deleted"):($("#edit-topic-form").form("set values",{sid:a,index:t,topic:T[a][t].topic,oldtopic:T[a][t].topic}),$(".edit-topic-dialog-wrapper.hide").removeClass("hide"))})),$("#update-topic-cancel").on("click",(function(e){e.preventDefault(),$(".edit-topic-dialog-wrapper").addClass("hide")})),$("#update-topic-submit").on("click",(function(e){e.preventDefault();let t=$("#edit-topic-form").form("get values"),a=parseInt(t.index,10);if(t.topic===t.oldtopic)return void $(".edit-topic-dialog-wrapper").addClass("hide");let o=function(e){let t={},a=e.replace(/[^a-zA-Z0-9ąćęłńóśźżĄĆĘŁŃÓŚŹŻ, ]/g,"");return a&&""!==a?(a=a.trim(),a=I()(a),t=/ /.test(a)?{value:a.replace(/ /g,""),topic:a}:{value:a,topic:a},t):t}(t.topic);if(console.log("old Topic: %o, new Topic: %o",T[t.sid][a],o),T[t.sid].find(e=>e.value===o.value))return void u.a.info("That topic already exists.");W(t.sid,"topicList"),$(".edit-topic-dialog-wrapper").addClass("hide");let n=T[t.sid][a];T[t.sid][a]=o,$(`[data-sid='${t.sid}'][data-index='${t.index}'] > .topic`).text(o.topic),$(`#topic-list-new > [data-value='${n.value}']`).attr("data-value",o.value).text(o.topic),A[t.sid].forEach(e=>{if(e.annotation.topicList){let a=e.annotation.topicList.findIndex(e=>e.value===n.value);a>-1&&(e.annotation.topicList[a]=o,e.modified=!0,W(t.sid,"bookmark"))}})})),$("#displayBookmarksButtonNew").on("click",(function(e){e.preventDefault();let t=$(this).attr("data-sid"),a={},o=$("#action-manager").form("get values");if(0===o.topicListNew.length)return void u.a.info("Select one or more topics from the Topic Select List");S("close"),P();let n=$(`#book-list${t} :selected`).val(),i="on"===o.condition?"AND":"OR",r=function(e,t,a,o){let n=a.split(","),i=!n.includes("*"),r=[];return i?A[e].forEach(e=>{let t=e.annotation.topicList,a=0;if(t&&t.length>0){for(let i=0;i<n.length;i++){let s=t.findIndex(e=>e.value===n[i]);if("OR"===o){if(s>-1){r.push(e);break}}else s>-1&&a++}a===n.length&&"AND"===o&&r.push(e)}}):r=A[e],"*"!==t&&(r=r.filter(e=>e.paraKey.startsWith(t))),r}(t,n,o.topicListNew,i);0!==r.length?($("#action-manager > .annotation-actions").removeClass("hide"),a.source=q.title[t],a.topicArray=o.topicListNew.split(","),a.condition=i,a.bookFilter=n,O(r,a)):u.a.info("No bookmarks contain selected topics")})),$("#action-manager > .annotation-actions input[type=radio][name=annotationFilter]").on("change",(function(e){let t=$("#action-manager").form("get values");"none"===t.annotationFilter?$(".bookmark-segment.hide").removeClass("hide"):"note"===t.annotationFilter?($(".bookmark-segment.note").removeClass("hide"),$(".bookmark-segment.selected").addClass("hide")):"selected"===t.annotationFilter&&($(".bookmark-segment.note").addClass("hide"),$(".bookmark-segment.selected").removeClass("hide"))})),$("#action-manager > .annotation-actions").on("click",".hide-quotes",(function(e){if($(this).hasClass("hide"))$(this).removeClass("hide").html("Hide Quotes"),$("#activity-report .bookmark-segment.qhide").removeClass("qhide");else{let e=$("#activity-report .cmi-manage-quote.in-database").parent();e.addClass("qhide"),$(this).addClass("hide").html(`Show Quotes (${e.length})`)}})),$("#action-manager > .annotation-actions").on("click",".hide-headers",(function(e){$(this).hasClass("hide")?($(this).removeClass("hide").html("Hide Headers"),$("#activity-report .bookmark-header").removeClass("hide")):($(this).addClass("hide").html("Show Headers"),$("#activity-report .bookmark-header").addClass("hide"))})),$("#confirmDelete").modal({closable:!1,onDeny:function(){u.a.info("Delete Canceled.")},onApprove:function(e){let t=parseInt($(e).attr("data-index"),10),a=$(e).attr("data-sid"),o=T[a][t];o.index=t,$(`#topicTable > tbody > [data-sid='${a}'][data-index='${t}']`).addClass("deleted"),$(`#topic-list-new > [data-value='${o.value}']`).addClass("deleted").attr("data-value","X"),T[a][t].deleted=!0,W(a,"topicList");let n=!1;A[a].forEach(e=>{if(e.annotation.topicList){let t=e.annotation.topicList.findIndex(e=>e.value===o.value);t>-1&&(e.annotation.topicList.splice(t,1),e.modified=!0,n=!0)}}),n&&W(a,"bookmark"),u.a.success(`Topic "${o.topic}" Deleted.`)}}),$("#applyChangesButtonNew").on("click",(function(){$(this).addClass("loading");let e=function(){let e=[],t=[];return Object.keys(D).forEach(a=>{if(!0===D[a].bookmark){A[a].filter(e=>e.modified).forEach(t=>{e.push(t)})}!0===D[a].topicList&&t.push(a)}),{bookmarks:e,topics:t}}(),t=Object(l.b)(),a=[];e.bookmarks.forEach(e=>{delete e.modified,delete e.pid,a.push(Object(y.e)(e))}),Promise.all(a).then(o=>(u.a.success(`${o.length} Annotation(s) Updated`),a=[],e.topics.forEach(e=>{let o=T[e].filter(e=>!e.deleted);a.push(Object(g.b)(t.userId,e,o))}),Promise.all(a))).then(e=>{u.a.success(`${e.length} topicList(s) Updated`),Object.keys(D).forEach(e=>{A[e].forEach(e=>{delete e.modified})}),D={},$("#applyChangesButtonNew").attr("disabled",""),u.a.success("Modifications Saved"),$(this).removeClass("loading")}).catch(e=>{u.a.error(`Error updating items: ${e}`),console.error(e),$(this).removeClass("loading")})}))}function L(){$("#activity-report").on("click",".cmi-manage-quote",(function(e){e.stopPropagation(),e.preventDefault();let t=Object(l.b)();if(!t)return;if($("#activity-report").hasClass("quote-editor-open"))return;$("#activity-report").addClass("quote-editor-open");let a={},o=$(this).text().trim(),[n,i,r]=o.substr(1).split(":"),s=$(this).prev("p").text().trim().replace(/\r?\n|\r/g," ");a.parakey=n,a.annotationId=i,a.pid=r,a.quote=s,a.userId=t.userId,a.url=Object(b.c)(n),a.citation=$(`#${i}`).text().trim(),$(this).append('\n    <form name="quote-editor" id="quote-editor-form" class="ui form">\n      <input class="hidden-field" type="text" readonly name="annotationId">\n      <input class="hidden-field" type="text" name="parakey" readonly>\n      <input class="hidden-field" type="text" name="pid" readonly>\n      <input class="hidden-field" type="text" name="userId" readonly>\n      <input class="hidden-field" type="text" name="url" readonly>\n      <input class="hidden-field" type="text" name="citation" readonly>\n      <div class="field">\n        <label>Edit Content for Display as a Quote</label>\n        <textarea name="quote" rows="5"></textarea>\n      </div>\n      <div class="field">\n        <label>Quote in Database</label>\n        <textarea name="database" readonly placeholder="Not in database." rows="5"></textarea>\n      </div>\n      <div class="fields">\n        <button class="quote-submit ui green button" type="submit">Add Quote</button>\n        <button class="quote-cancel ui red basic button">Cancel</button>\n        <div class="twelve wide field">\n          <button class="quote-delete ui red disabled right floated button">Delete</button>\n        </div>\n      </div>\n    </form>\n  '),async function(e){let t=$("#quote-editor-form");$("#quote-editor-form").addClass("loading");try{let a=await function(e,t,a){let o=`${w.a.user}/quoteData/${e}/${t}/${a}`;return new Promise((e,t)=>{C.a.get(o).then(t=>{e(t.data.quote)}).catch(e=>{t(e)})})}(e.userId,e.parakey,e.annotationId);a.q&&(e.database=a.q.quote,$("#quote-editor-form .quote-delete").removeClass("disabled"),$("#quote-editor-form button.quote-submit").text("Update Quote"),E(e.parakey,e.annotationId,!1)),$("#quote-editor-form").removeClass("loading"),t.form("set values",e)}catch(e){u.a.error(e),console.log("Error getting quote from database: %w",e)}}(a)})),$("#activity-report").on("click","#quote-editor-form .quote-submit",(async function(e){e.stopPropagation(),e.preventDefault();let t=$("#quote-editor-form").form("get values"),a=$(this).text().startsWith("Add")?"Added":"Updated",o={userId:t.userId,paraKey:t.parakey,creationDate:t.annotationId,quote:{pid:t.pid,quote:Object(m.a)(t.quote),url:t.url,citation:t.citation}};N(),G();try{await function(e){let t=`${w.a.user}/quote`;return new Promise((a,o)=>{C.a.post(t,e).then(e=>{a(e.data.response)}).catch(e=>{o(e)})})}(o);u.a.info(`Quote ${a}`),E(t.parakey,t.annotationId)}catch(e){console.error("error posting quote to db: %o",e),u.a.error(e)}})),$("#activity-report").on("click","#quote-editor-form .quote-cancel",(function(e){e.stopPropagation(),e.preventDefault(),N(),G()})),$("#activity-report").on("click","#quote-editor-form .quote-delete",(async function(e){e.stopPropagation(),e.preventDefault();let t=$("#quote-editor-form").form("get values");try{await function(e,t,a){let o=`${w.a.user}/quote/${e}/${t}/${a}`;return new Promise((e,t)=>{C.a.delete(o).then(t=>{e(t.data.response)}).catch(e=>{t(e)})})}(t.userId,t.parakey,t.annotationId);u.a.info("Quote deleted from database"),a=t.parakey,o=t.annotationId,z(a,o,!1),$(`.${o}`).removeClass("in-database")}catch(e){u.a.error(`failed to delete quote: ${e.message}`)}var a,o;N(),G()}))}function N(){$("#quote-editor-form").remove()}function G(){$("#activity-report").removeClass("quote-editor-open")}function E(e,t,a=!0){a&&z(e,t,!0),$(`.${t}`).addClass("in-database")}function z(e,t,a){let o=A[e.substring(0,2)].find(a=>a.paraKey===e&&a.creationDate===t);o&&(o.modified=!0,o.quote=a,W(e.substring(0,2),"bookmark"))}function W(e,t){D[e]?D[e].hasOwnProperty(t)||(D[e][t]=!0):D[e]={[t]:!0},$("#applyChangesButtonNew").removeAttr("disabled")}function Q(){if(!Object(l.b)())return u.a.warning("You must be signed in to edit your email list"),void setTimeout(()=>{location.href="/"},3e3);B(),L(),window.onbeforeunload=function(e){var t;if("disabled"!==$("#applyChangesButtonNew").attr("disabled"))return t="Please click 'Apply' to save your changes.",void 0===e&&(e=window.event),e&&(e.returnValue=t),t}}$("button.source-select").on("click",(function(e){e.preventDefault();let t=$(this).attr("data-sid"),a=$(this).attr("class");a.includes("collapse")&&($(this).removeClass("collapse"),$(this).addClass("show-all"),$(this).text("Show All"),function(e){$("#sourceTable > tbody > tr").each((function(){$(this).attr("id")!==e&&$(this).addClass("hide")})),function(e){j(e),$(".annotation-actions").addClass("hide"),$("#action-manager").removeClass("hide")}(e)}(t)),a.includes("show-all")&&($(this).addClass("collapse"),$(this).removeClass("show-all"),$(this).text("Focus"),S("close"),M(),P(),$("#sourceTable > tbody > tr").each((function(){$(this).removeClass("hide")})),$("#action-manager").addClass("hide"),$("#manageTopicsButton").attr("disabled",""),$("#displayBookmarksButtonNew").attr("disabled",""),$("#topicTable").addClass("hide")),a.includes("bookmarks")&&function(e,t){$(t).addClass("loading"),function(e){let t=Object(l.b)();return new Promise((a,o)=>{let n=Object(g.a)(t.userId,e).then(t=>{T[e]=t,u.a.success(`${T[e].length} topics loaded`)}).catch(e=>{console.error("error fetching topicList: %s",e),u.a.error(e),o(e)}),i=Object(y.c)(t.userId,e).then(t=>{A[e]=t,A[e].forEach(e=>{e.modified=!1}),u.a.success(`${A[e].length} bookmarks loaded`)}).catch(e=>{console.error("error fetching bookmarks: %s",e),u.a.error(e),o(e)});Promise.all([n,i]).then(t=>{let o={topics:T[e].length,bookmarks:A[e].length};a(o)})})}(e).then(a=>{$(`#load-button-${e}`).html(`Topics: ${a.topics}<br>Annotations: ${a.bookmarks}`),$(t).removeClass("loading"),$("#action-manager").hasClass("hide")||j(e)}).catch(e=>{$(t).removeClass("loading")})}(t,this)}));var H=a(2),_=a(7);$(document).ready(()=>{Object(o.b)(_.a),Object(n.b)(),Object(H.c)(_.a),Object(i.a)("page"),r.a.initialize(),l.a.initialize(),s.a.initialize("transcript"),d.a.initialize(),1===$(".manage-email-list").length&&async function(){let e=Object(l.b)();if(!e)return u.a.warning("You must be signed in to edit your email list"),void setTimeout(()=>{location.href="/"},3e3);e.userId,$(".sync.icon").addClass("loading");try{h=await Object(p.a)(e.userId),$(".sync.icon.loading").removeClass("loading");let t=function(e){return`\n    ${e.map((e,t)=>`\n      <tr data-index="${t}">\n        <td class="delete-maillist-item"><i class="trash alternate icon"></i></td>\n        <td class="edit-maillist-item"><i class="pencil alternate icon"></i></td>\n        <td data-name="first">${e.first}</td>\n        <td data-name="last">${e.last}</td>\n        <td data-name="address">${e.address}</td>\n      </tr>\n    `).join("")}\n  `}(h);$("#email-list-table").html(t),v()}catch(e){$(".sync.icon.loading").removeClass("loading"),u.a.error(`Error getting email list: ${e}`)}}(),1===$(".manage-topic-list").length&&Q()})}});